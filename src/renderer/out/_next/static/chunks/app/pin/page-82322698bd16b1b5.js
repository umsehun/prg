(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[34],{387:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(2068).A)("target",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]])},826:(e,t,s)=>{"use strict";s.d(t,{cn:()=>l});var a=s(2902),r=s(3714);function l(){for(var e=arguments.length,t=Array(e),s=0;s<e;s++)t[s]=arguments[s];return(0,r.QP)((0,a.$)(t))}},1119:(e,t,s)=>{"use strict";s.d(t,{a:()=>r});class a{static getInstance(){return a.instance||(a.instance=new a),a.instance}get api(){if(!window.electronAPI)throw Error("Electron API not available. Make sure this is running in Electron.");return window.electronAPI}async getDifficulties(e){return await this.api.game.getDifficulties(e)}async startGame(e){let t=await this.api.game.start(e);if(!t.success)throw Error(t.error||"Failed to start game");return{sessionId:"mock-session-"+Date.now(),chartId:e.chartId,startTime:Date.now(),score:0,accuracy:1,combo:0}}async stopGame(){let e=await this.api.game.stop();if(!e.success)throw Error(e.error||"Failed to stop game")}async pauseGame(){let e=await this.api.game.pause();if(!e.success)throw Error(e.error||"Failed to pause game")}async resumeGame(){let e=await this.api.game.resume();if(!e.success)throw Error(e.error||"Failed to resume game")}throwKnife(e){this.api.game.throwKnife({id:e.id,time:e.time})}onKnifeResult(e){return this.api.game.onKnifeResult(e)}async getChartLibrary(){let e=await this.api.osz.getLibrary();if(!e.success)throw Error(e.error||"Failed to load chart library");return e.charts||[]}async getChart(e){let t=(await this.getChartLibrary()).find(t=>t.id===e);if(!t)throw Error("Chart ".concat(e," not found"));return t}async importChart(e){let t=await this.api.osz.import(e);return{success:t.success,error:t.error}}async removeChart(e){let t=await this.api.osz.removeChart(e);if(!t.success)throw Error(t.error||"Failed to remove chart")}async getChartAudio(e){let t=await this.api.osz.getAudio(e);if(!t.success)throw Error(t.error||"Failed to get audio");return"mock-audio-url"}async getChartBackground(e){return"mock-background-url"}async getSettings(){let e=await this.api.settings.getAll();if(!e.success)throw Error(e.error||"Failed to load settings");return e.settings||{audio:{masterVolume:1,musicVolume:.8,effectVolume:.6,enableFeedback:!0},game:{scrollSpeed:1,noteSize:1,enableParticles:!0,showFps:!1},display:{fullscreen:!1,vsync:!0,targetFps:60},controls:{keyBindings:{lane1:"D",lane2:"F",lane3:"J",lane4:"K"}}}}async setSetting(e,t){let s=await this.api.settings.set(e,t);if(!s.success)throw Error(s.error||"Failed to update setting")}async resetSettings(){let e=await this.api.settings.reset();if(!e.success)throw Error(e.error||"Failed to reset settings")}onSettingsChange(e){return this.api.settings.onChange(t=>{this.getSettings().then(e).catch(console.error)})}async getVersion(){return this.api.system.version||"0.1.0"}async openExternal(e){window.open(e,"_blank")}async showMessageBox(e){return{response:0}}}let r=a.getInstance()},1454:(e,t,s)=>{"use strict";s.d(t,{v:()=>l});var a=s(7620),r=s(1119);function l(){let[e,t]=(0,a.useState)(null),[s,l]=(0,a.useState)("osu"),[i,n]=(0,a.useState)("idle"),[o,c]=(0,a.useState)({score:0,combo:0,accuracy:100,hits:{perfect:0,great:0,good:0,miss:0}}),d=(0,a.useRef)(0),u="playing"===i,h=(0,a.useCallback)(async function(e){arguments.length>1&&void 0!==arguments[1]&&arguments[1];try{n("loading");try{await r.a.stopGame(),console.log("\uD83D\uDED1 Stopped existing game session")}catch(e){console.log("ℹ️ No existing game to stop:",e)}console.log("\uD83C\uDFAE Starting pin game with song:",e.title,"(ID:",e.id,")");let s={chartId:e.id,difficulty:"Normal",gameMode:"osu",mods:[]};console.log("\uD83C\uDFAE Starting game with new API params:",s);let a=await r.a.startGame(s);return console.log("\uD83C\uDFAE Pin game session started:",a),t(e),l("pin"),n("playing"),d.current=Date.now(),y(),!0}catch(e){return console.error("❌ Game start failed:",e),n("idle"),!1}},[]),m=(0,a.useCallback)(async()=>{try{"playing"===i||"paused"===i?await r.a.stopGame():console.log("\uD83D\uDED1 No game running, skipping stop command"),n("idle"),t(null)}catch(e){console.log("ℹ️ Stop game error (may be expected):",e),n("idle"),t(null)}},[i]),g=(0,a.useCallback)(async()=>{try{var e,t;(null==(t=window.electronAPI)||null==(e=t.game)?void 0:e.pause)&&(await window.electronAPI.game.pause(),n("paused"))}catch(e){console.error("❌ Failed to pause game:",e)}},[]),x=(0,a.useCallback)(async()=>{try{var e,t;(null==(t=window.electronAPI)||null==(e=t.game)?void 0:e.resume)&&(await window.electronAPI.game.resume(),n("playing"))}catch(e){console.error("❌ Failed to resume game:",e)}},[]),p=(0,a.useCallback)(e=>{c(t=>({...t,...e}))},[]),f=(0,a.useCallback)(async()=>{if(!e)return!1;try{var t;let s={songId:e.id,score:o.score,accuracy:o.accuracy,combo:o.combo,rank:(t=o.accuracy)>=97?"SS":t>=90?"S":t>=80?"A":t>=70?"B":t>=60?"C":t>=50?"D":"F",timestamp:Date.now()};return console.log("\uD83D\uDCCA Score submission (TODO):",s),!0}catch(e){return console.error("❌ Failed to submit score:",e),!1}},[e,o]),y=(0,a.useCallback)(()=>{c({score:0,combo:0,accuracy:100,hits:{perfect:0,great:0,good:0,miss:0}})},[]);return{currentSong:e,gameMode:s,gameState:i,stats:o,isPlaying:u,startGame:h,stopGame:m,pauseGame:g,resumeGame:x,updateStats:p,submitScore:f,resetStats:y}}},1715:(e,t,s)=>{"use strict";s.d(t,{s:()=>i,t:()=>l});var a=s(7620);function r(e,t){if("function"==typeof e)return e(t);null!=e&&(e.current=t)}function l(...e){return t=>{let s=!1,a=e.map(e=>{let a=r(e,t);return s||"function"!=typeof a||(s=!0),a});if(s)return()=>{for(let t=0;t<a.length;t++){let s=a[t];"function"==typeof s?s():r(e[t],null)}}}}function i(...e){return a.useCallback(l(...e),e)}},1765:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>v});var a=s(4568),r=s(7620),l=s(5239),i=s(1454),n=s(7541);class o{async initializeAudioContext(){try{this.context=new AudioContext({latencyHint:"interactive",sampleRate:44100}),this.gainNode=this.context.createGain(),this.gainNode.connect(this.context.destination),"suspended"===this.context.state&&await this.context.resume()}catch(e){console.error("Failed to initialize Audio Context:",e)}}async loadAudio(e){if(!this.context)return console.error("Audio context not initialized"),!1;try{return this.audioBuffer=await this.context.decodeAudioData(e),!0}catch(e){return console.error("Failed to decode audio data:",e),!1}}play(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;if(!this.context||!this.audioBuffer)return console.error("Audio not loaded or context not available"),!1;try{this.stop(),this.sourceNode=this.context.createBufferSource(),this.sourceNode.buffer=this.audioBuffer,this.sourceNode.connect(this.gainNode);let t=this.context.currentTime;return this.sourceNode.start(t,e),this.startTime=t-e,this.isPlaying=!0,this.isPaused=!1,this.pauseTime=0,!0}catch(e){return console.error("Failed to play audio:",e),!1}}pause(){if(!this.isPlaying||this.isPaused||!this.sourceNode)return!1;try{return this.pauseTime=this.getCurrentTime(),this.sourceNode.stop(),this.sourceNode=null,this.isPaused=!0,this.isPlaying=!1,!0}catch(e){return console.error("Failed to pause audio:",e),!1}}resume(){return!!this.isPaused&&this.play(this.pauseTime/1e3)}stop(){if(this.sourceNode){try{this.sourceNode.stop()}catch(e){}this.sourceNode=null}this.isPlaying=!1,this.isPaused=!1,this.startTime=0,this.pauseTime=0}getCurrentTime(){return this.context?this.isPaused?this.pauseTime:this.isPlaying&&this.sourceNode?1e3*(this.context.currentTime-this.startTime):0:0}setVolume(e){this.gainNode&&(this.gainNode.gain.value=Math.max(0,Math.min(1,e)))}getDuration(){return this.audioBuffer?1e3*this.audioBuffer.duration:0}getIsPlaying(){return this.isPlaying}getIsPaused(){return this.isPaused}dispose(){this.stop(),this.context&&(this.context.close(),this.context=null),this.audioBuffer=null,this.gainNode=null}constructor(){this.context=null,this.audioBuffer=null,this.sourceNode=null,this.gainNode=null,this.startTime=0,this.pauseTime=0,this.isPlaying=!1,this.isPaused=!1,this.initializeAudioContext()}}function c(e){let{targetRotation:t,pins:s,hitEffects:l,currentPinAngle:i,gameState:n,width:o=600,height:c=600}=e,d=(0,r.useRef)(null),u=(0,r.useRef)(),h=(0,r.useCallback)(()=>{let e=d.current;if(!e)return;let a=e.getContext("2d");if(!a)return;a.clearRect(0,0,e.width,e.height);let r=e.width/2,o=e.height/2;a.beginPath(),a.arc(r,o,150,0,2*Math.PI),a.strokeStyle="#8b5cf6",a.lineWidth=3,a.stroke(),a.beginPath(),a.arc(r,o,5,0,2*Math.PI),a.fillStyle="#8b5cf6",a.fill(),s.forEach(e=>{let t=r+150*Math.cos(e.angle*Math.PI/180),s=o+150*Math.sin(e.angle*Math.PI/180);a.beginPath(),a.moveTo(t,s),a.lineTo(t+40*Math.cos(e.angle*Math.PI/180),s+40*Math.sin(e.angle*Math.PI/180)),a.strokeStyle="#fbbf24",a.lineWidth=4,a.stroke(),a.beginPath(),a.arc(t+40*Math.cos(e.angle*Math.PI/180),s+40*Math.sin(e.angle*Math.PI/180),3,0,2*Math.PI),a.fillStyle="#f59e0b",a.fill()});let c=r+180*Math.cos((t+i)*Math.PI/180),m=o+180*Math.sin((t+i)*Math.PI/180);a.beginPath(),a.arc(c,m,8,0,2*Math.PI),a.fillStyle="#ef4444",a.fill(),a.beginPath(),a.moveTo(c,m),a.lineTo(r,o),a.strokeStyle="#ef444440",a.lineWidth=2,a.setLineDash([5,5]),a.stroke(),a.setLineDash([]),l.forEach(e=>{let t=Date.now()-e.timestamp,s=Math.max(0,1-t/1e3);a.save(),a.globalAlpha=s,a.font="".concat(20*(1+t/1e3*.5),"px bold"),a.textAlign="center","PERFECT"===e.type?(a.fillStyle="#22c55e",a.fillText("PERFECT!",r+e.x,o+e.y)):"GOOD"===e.type?(a.fillStyle="#eab308",a.fillText("GOOD!",r+e.x,o+e.y)):(a.fillStyle="#ef4444",a.fillText("MISS!",r+e.x,o+e.y)),a.restore()}),"playing"===n&&(u.current=requestAnimationFrame(h))},[t,s,l,i,n]);return(0,r.useEffect)(()=>(h(),()=>{u.current&&cancelAnimationFrame(u.current)}),[h]),(0,a.jsx)("canvas",{ref:d,width:o,height:c,className:"w-full h-auto bg-slate-900 rounded-lg border border-slate-600",style:{maxWidth:"".concat(o,"px"),maxHeight:"".concat(c,"px")}})}var d=s(6862),u=s(2068);let h=(0,u.A)("award",[["path",{d:"m15.477 12.89 1.515 8.526a.5.5 0 0 1-.81.47l-3.58-2.687a1 1 0 0 0-1.197 0l-3.586 2.686a.5.5 0 0 1-.81-.469l1.514-8.526",key:"1yiouv"}],["circle",{cx:"12",cy:"8",r:"6",key:"1vp47v"}]]);var m=s(387);let g=(0,u.A)("trending-up",[["path",{d:"M16 7h6v6",key:"box55l"}],["path",{d:"m22 7-8.5 8.5-5-5L2 17",key:"1t1m79"}]]);function x(e){let{stats:t,currentSong:s,gameInfo:r}=e,i=t.combo>=50?{text:"".concat(t.combo,"x"),color:"text-purple-400",bg:"bg-purple-900/30"}:t.combo>=20?{text:"".concat(t.combo,"x"),color:"text-yellow-400",bg:"bg-yellow-900/30"}:t.combo>=10?{text:"".concat(t.combo,"x"),color:"text-blue-400",bg:"bg-blue-900/30"}:{text:"".concat(t.combo,"x"),color:"text-white",bg:"bg-slate-700/30"},n=t.accuracy>=95?{grade:"S",color:"text-yellow-300"}:t.accuracy>=90?{grade:"A",color:"text-green-400"}:t.accuracy>=80?{grade:"B",color:"text-blue-400"}:t.accuracy>=70?{grade:"C",color:"text-purple-400"}:{grade:"D",color:"text-red-400"};return(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)(l.Zp,{className:"bg-slate-800/50 border-slate-700",children:[(0,a.jsx)(l.aR,{className:"pb-3",children:(0,a.jsxs)(l.ZB,{className:"text-lg text-purple-300 flex items-center",children:[(0,a.jsx)(d.A,{className:"w-5 h-5 mr-2"}),"점수"]})}),(0,a.jsxs)(l.Wu,{children:[(0,a.jsx)("div",{className:"text-3xl font-bold text-white mb-2",children:t.score.toLocaleString()}),(0,a.jsxs)("div",{className:"text-lg font-bold ".concat(i.color," ").concat(i.bg," px-2 py-1 rounded-md inline-block"),children:["콤보: ",i.text]})]})]}),(0,a.jsxs)(l.Zp,{className:"bg-slate-800/50 border-slate-700",children:[(0,a.jsx)(l.aR,{className:"pb-3",children:(0,a.jsxs)(l.ZB,{className:"text-lg text-purple-300 flex items-center",children:[(0,a.jsx)(h,{className:"w-5 h-5 mr-2"}),"정확도"]})}),(0,a.jsxs)(l.Wu,{children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,a.jsxs)("span",{className:"text-2xl font-bold ".concat(t.accuracy>=95?"text-green-400":t.accuracy>=85?"text-yellow-400":t.accuracy>=70?"text-orange-400":"text-red-400"),children:[t.accuracy,"%"]}),(0,a.jsx)("span",{className:"text-4xl font-bold ".concat(n.color),children:n.grade})]}),(0,a.jsx)("div",{className:"w-full bg-slate-700 rounded-full h-2",children:(0,a.jsx)("div",{className:"h-2 rounded-full transition-all duration-300 ".concat(t.accuracy>=95?"bg-green-500":t.accuracy>=85?"bg-yellow-500":t.accuracy>=70?"bg-orange-500":"bg-red-500"),style:{width:"".concat(t.accuracy,"%")}})})]})]}),(0,a.jsxs)(l.Zp,{className:"bg-slate-800/50 border-slate-700",children:[(0,a.jsx)(l.aR,{className:"pb-3",children:(0,a.jsxs)(l.ZB,{className:"text-lg text-purple-300 flex items-center",children:[(0,a.jsx)(m.A,{className:"w-5 h-5 mr-2"}),"판정"]})}),(0,a.jsxs)(l.Wu,{className:"space-y-2",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsx)("span",{className:"text-green-400 font-medium",children:"PERFECT"}),(0,a.jsx)("span",{className:"text-white font-bold",children:t.hits.perfect})]}),(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsx)("span",{className:"text-yellow-400 font-medium",children:"GOOD"}),(0,a.jsx)("span",{className:"text-white font-bold",children:t.hits.good})]}),(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsx)("span",{className:"text-red-400 font-medium",children:"MISS"}),(0,a.jsx)("span",{className:"text-white font-bold",children:t.hits.miss})]}),(0,a.jsx)("div",{className:"border-t border-slate-600 pt-2 mt-2",children:(0,a.jsxs)("div",{className:"flex justify-between items-center font-bold",children:[(0,a.jsx)("span",{className:"text-purple-300",children:"총 히트"}),(0,a.jsx)("span",{className:"text-white",children:t.hits.perfect+t.hits.good+t.hits.miss})]})})]})]}),(s||r)&&(0,a.jsxs)(l.Zp,{className:"bg-slate-800/50 border-slate-700",children:[(0,a.jsx)(l.aR,{className:"pb-3",children:(0,a.jsxs)(l.ZB,{className:"text-lg text-purple-300 flex items-center",children:[(0,a.jsx)(g,{className:"w-5 h-5 mr-2"}),"게임 정보"]})}),(0,a.jsxs)(l.Wu,{className:"space-y-2 text-sm",children:[s&&(0,a.jsx)(a.Fragment,{children:(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{className:"text-slate-400",children:"BPM"}),(0,a.jsx)("span",{className:"text-white",children:s.bpm})]})}),r&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{className:"text-slate-400",children:"회전 속도"}),(0,a.jsx)("span",{className:"text-white",children:r.rotationSpeed.toFixed(1)})]}),(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{className:"text-slate-400",children:"핀 개수"}),(0,a.jsx)("span",{className:"text-white",children:r.pinCount})]}),(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{className:"text-slate-400",children:"난이도"}),(0,a.jsx)("span",{className:"text-white",children:r.difficulty})]})]})]})]})]})}var p=s(6845),f=s(2292),y=s(8756);let b=(0,u.A)("square",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}]]);var w=s(4751);function N(e){let{gameState:t,onPinThrow:s,onPause:r,onResume:l,onStop:i,onBack:n,disabled:o=!1,showThrowButton:c=!0}=e;return(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"text-lg font-medium ".concat((()=>{switch(t){case"playing":return"text-green-400";case"paused":return"text-orange-400";case"ended":case"finished":return"text-red-400";case"loading":return"text-blue-400";default:return"text-slate-400"}})()),children:(()=>{switch(t){case"idle":return"게임 시작 대기";case"loading":return"로딩 중...";case"playing":return"플레이 중";case"paused":return"일시정지";case"ended":case"finished":return"게임 종료";default:return"대기"}})()}),"playing"===t&&(0,a.jsx)("div",{className:"text-sm text-slate-400 mt-1",children:"스페이스바를 눌러 핀을 던지세요!"})]}),(0,a.jsxs)("div",{className:"flex flex-col gap-3",children:[c&&(0,a.jsxs)(p.$,{onClick:s,disabled:"playing"!==t||o,className:"w-full bg-purple-500 hover:bg-purple-600 text-lg px-6 py-4 h-auto",children:[(0,a.jsx)(m.A,{className:"w-6 h-6 mr-2"}),"핀 던지기",(0,a.jsx)("div",{className:"text-sm opacity-75 ml-2",children:"(Space)"})]}),(0,a.jsxs)("div",{className:"flex gap-2",children:["playing"===t&&(0,a.jsxs)(p.$,{onClick:r,className:"flex-1 bg-orange-500 hover:bg-orange-600",disabled:o,children:[(0,a.jsx)(f.A,{className:"w-4 h-4 mr-2"}),"일시정지"]}),"paused"===t&&(0,a.jsxs)(p.$,{onClick:l,className:"flex-1 bg-green-500 hover:bg-green-600",disabled:o,children:[(0,a.jsx)(y.A,{className:"w-4 h-4 mr-2"}),"재개"]}),(0,a.jsxs)(p.$,{onClick:i,variant:"destructive",className:"flex-1",disabled:"idle"===t||o,children:[(0,a.jsx)(b,{className:"w-4 h-4 mr-2"}),"정지"]})]}),(0,a.jsxs)(p.$,{onClick:n,variant:"outline",className:"w-full border-slate-600",disabled:o,children:[(0,a.jsx)(w.A,{className:"w-4 h-4 mr-2"}),"곡 선택으로 돌아가기"]})]}),"playing"===t&&(0,a.jsxs)("div",{className:"bg-slate-800/30 rounded-lg p-3 text-sm",children:[(0,a.jsx)("div",{className:"text-slate-300 font-medium mb-2",children:"키보드 단축키:"}),(0,a.jsxs)("div",{className:"space-y-1 text-slate-400",children:[(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{children:"핀 던지기"}),(0,a.jsx)("code",{className:"bg-slate-700 px-2 py-1 rounded",children:"Space"})]}),(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{children:"일시정지"}),(0,a.jsx)("code",{className:"bg-slate-700 px-2 py-1 rounded",children:"Esc"})]})]})]})]})}function v(){let e=(0,n.useRouter)(),{currentSong:t,gameState:s,stats:d,pauseGame:u,resumeGame:h,stopGame:m,updateStats:g}=(0,i.v)(),p=(0,r.useRef)(null),[f,y]=(0,r.useState)(0),[b,w]=(0,r.useState)([]),[v,j]=(0,r.useState)(2),[k,C]=(0,r.useState)([]),[S,P]=(0,r.useState)(0);(0,r.useEffect)(()=>(p.current=new o,()=>{p.current&&p.current.stop()}),[]),(0,r.useEffect)(()=>{async function e(){if(t&&"playing"===s&&p.current)try{if(console.log("\uD83C\uDFB5 Loading audio:",t.audioFile),t.audioFile){let e=await fetch("file://".concat(t.audioFile)),s=await e.arrayBuffer();await p.current.loadAudio(s)&&(console.log("\uD83C\uDFB5 Starting audio playback"),p.current.play())}}catch(e){console.error("❌ Failed to load audio:",e)}}"playing"===s&&e()},[t,s]);let A=function(e){let{pins:t,onHitResult:s,onStatsUpdate:a,currentStats:l}=e,i=(0,r.useCallback)(e=>{for(let s of t){let t=Math.abs(e-s.angle);if(10>Math.min(t,360-t))return"MISS"}let s=Math.random();return s>.8?"PERFECT":s>.5?"GOOD":"MISS"},[t]),n=(0,r.useCallback)(e=>{let t=i(e),r={id:Date.now(),x:150*Math.cos(e*Math.PI/180)*.7,y:150*Math.sin(e*Math.PI/180)*.7,type:t,timestamp:Date.now()},n={...l};"PERFECT"===t?(n.hits.perfect++,n.score+=300+5*l.combo,n.combo++):"GOOD"===t?(n.hits.good++,n.score+=100+2*l.combo,n.combo++):(n.hits.miss++,n.combo=0);let o=n.hits.perfect+n.hits.good+n.hits.miss,c=n.hits.perfect+n.hits.good;return n.accuracy=o>0?Math.round(c/o*100):100,s(t,r),a(n),t},[i,s,a,l]),o=(0,r.useCallback)((e,t)=>{let s=60/t*1e3,a=e%s/s;return 1-2*Math.min(a,1-a)},[]);return{processHit:n,checkHitDetection:i,calculateRhythmTiming:o,isThrowSafe:(0,r.useCallback)(e=>{for(let s of t){let t=Math.abs(e-s.angle);if(30>Math.min(t,360-t))return!1}return!0},[t]),getDifficultyMultiplier:(0,r.useCallback)(()=>{let e=t.length;return e<5?1:e<10?1.2:e<15?1.5:2},[t.length]),getAccuracy:()=>l.accuracy,getCombo:()=>l.combo,getScore:()=>l.score}}({pins:b,onHitResult:(0,r.useCallback)((e,t)=>{if(C(e=>[...e,t]),"MISS"!==e){let e={id:Date.now(),angle:(f+S)%360,timestamp:Date.now(),stuck:!0};w(t=>[...t,e]),d.combo>0&&d.combo%10==0&&j(e=>Math.min(e+.2,5))}setTimeout(()=>{C(e=>e.filter(e=>e.id!==t.id))},1e3)},[f,S,d.combo]),onStatsUpdate:g,currentStats:d});(0,r.useEffect)(()=>{if("playing"===s){let e=setInterval(()=>{y(e=>(e+v)%360)},16);return()=>clearInterval(e)}},[s,v]);let M=(0,r.useCallback)(()=>{if("playing"!==s||!t)return;let e=(f+S)%360;A.processHit(e)},[s,t,f,S,A]);(0,r.useEffect)(()=>{let e=e=>{"Space"===e.code?(e.preventDefault(),M()):"Escape"===e.code&&(e.preventDefault(),"playing"===s?u():"paused"===s&&h())};return window.addEventListener("keydown",e),()=>window.removeEventListener("keydown",e)},[M,s,u,h]);let E=(0,r.useCallback)(()=>{m(),e.push("/select")},[m,e]),I=(0,r.useCallback)(()=>{m(),w([]),C([]),y(0),j(2)},[m]);return t?(0,a.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-slate-900 via-purple-900 to-slate-900 p-4",children:(0,a.jsxs)("div",{className:"max-w-7xl mx-auto",children:[(0,a.jsxs)("div",{className:"mb-6",children:[(0,a.jsx)("h1",{className:"text-3xl font-bold text-purple-300 mb-2",children:"핀 게임"}),(0,a.jsxs)("p",{className:"text-slate-400",children:[t.title," - ",t.artist]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-6",children:[(0,a.jsx)("div",{className:"lg:col-span-3",children:(0,a.jsx)(l.Zp,{className:"bg-slate-800/50 border-slate-700",children:(0,a.jsx)(l.Wu,{className:"p-6",children:(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)(c,{targetRotation:f,pins:b,hitEffects:k,currentPinAngle:S,gameState:s,width:600,height:600}),"playing"!==s&&(0,a.jsx)("div",{className:"absolute inset-0 bg-black/50 flex items-center justify-center rounded-lg",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("h3",{className:"text-2xl font-bold text-white mb-4",children:"idle"===s?"게임 시작 대기":"paused"===s?"일시정지":"loading"===s?"로딩 중...":"게임 종료"}),"paused"===s&&(0,a.jsx)("p",{className:"text-slate-300",children:"재개하려면 플레이 버튼을 클릭하거나 ESC를 누르세요"})]})})]})})})}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsx)(l.Zp,{className:"bg-slate-800/50 border-slate-700",children:(0,a.jsx)(l.Wu,{className:"p-4",children:(0,a.jsx)(N,{gameState:s,onPinThrow:M,onPause:u,onResume:h,onStop:I,onBack:E})})}),(0,a.jsx)(x,{stats:d,currentSong:t,gameInfo:{rotationSpeed:v,pinCount:b.length,difficulty:A.getDifficultyMultiplier()>1.5?"Hard":A.getDifficultyMultiplier()>1.2?"Normal":"Easy"}})]})]})]})}):(0,a.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-slate-900 via-purple-900 to-slate-900 p-8",children:(0,a.jsx)("div",{className:"max-w-4xl mx-auto",children:(0,a.jsx)(l.Zp,{className:"bg-slate-800/50 border-slate-700",children:(0,a.jsxs)(l.Wu,{className:"p-8 text-center",children:[(0,a.jsx)("h2",{className:"text-2xl font-bold text-purple-300 mb-4",children:"곡을 선택해주세요"}),(0,a.jsx)("p",{className:"text-slate-400 mb-6",children:"핀 게임을 시작하려면 먼저 곡을 선택해야 합니다."}),(0,a.jsx)(N,{gameState:"idle",onPinThrow:()=>{},onPause:()=>{},onResume:()=>{},onStop:()=>{},onBack:E,showThrowButton:!1})]})})})})}},2292:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(2068).A)("pause",[["rect",{x:"14",y:"3",width:"5",height:"18",rx:"1",key:"kaeet6"}],["rect",{x:"5",y:"3",width:"5",height:"18",rx:"1",key:"1wsw3u"}]])},4616:(e,t,s)=>{"use strict";s.d(t,{F:()=>i});var a=s(2902);let r=e=>"boolean"==typeof e?`${e}`:0===e?"0":e,l=a.$,i=(e,t)=>s=>{var a;if((null==t?void 0:t.variants)==null)return l(e,null==s?void 0:s.class,null==s?void 0:s.className);let{variants:i,defaultVariants:n}=t,o=Object.keys(i).map(e=>{let t=null==s?void 0:s[e],a=null==n?void 0:n[e];if(null===t)return null;let l=r(t)||r(a);return i[e][l]}),c=s&&Object.entries(s).reduce((e,t)=>{let[s,a]=t;return void 0===a||(e[s]=a),e},{});return l(e,o,null==t||null==(a=t.compoundVariants)?void 0:a.reduce((e,t)=>{let{class:s,className:a,...r}=t;return Object.entries(r).every(e=>{let[t,s]=e;return Array.isArray(s)?s.includes({...n,...c}[t]):({...n,...c})[t]===s})?[...e,s,a]:e},[]),null==s?void 0:s.class,null==s?void 0:s.className)}},4751:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(2068).A)("arrow-left",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]])},5239:(e,t,s)=>{"use strict";s.d(t,{BT:()=>c,Wu:()=>d,ZB:()=>o,Zp:()=>i,aR:()=>n});var a=s(4568),r=s(7620),l=s(826);let i=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)("div",{ref:t,className:(0,l.cn)("rounded-xl border bg-card text-card-foreground shadow",s),...r})});i.displayName="Card";let n=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)("div",{ref:t,className:(0,l.cn)("flex flex-col space-y-1.5 p-6",s),...r})});n.displayName="CardHeader";let o=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)("h3",{ref:t,className:(0,l.cn)("font-semibold leading-none tracking-tight",s),...r})});o.displayName="CardTitle";let c=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)("p",{ref:t,className:(0,l.cn)("text-sm text-muted-foreground",s),...r})});c.displayName="CardDescription";let d=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)("div",{ref:t,className:(0,l.cn)("p-6 pt-0",s),...r})});d.displayName="CardContent",r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)("div",{ref:t,className:(0,l.cn)("flex items-center p-6 pt-0",s),...r})}).displayName="CardFooter"},5464:(e,t,s)=>{Promise.resolve().then(s.bind(s,1765))},6118:(e,t,s)=>{"use strict";s.d(t,{DX:()=>n,TL:()=>i});var a=s(7620),r=s(1715),l=s(4568);function i(e){let t=function(e){let t=a.forwardRef((e,t)=>{let{children:s,...l}=e;if(a.isValidElement(s)){var i;let e,n,o=(i=s,(n=(e=Object.getOwnPropertyDescriptor(i.props,"ref")?.get)&&"isReactWarning"in e&&e.isReactWarning)?i.ref:(n=(e=Object.getOwnPropertyDescriptor(i,"ref")?.get)&&"isReactWarning"in e&&e.isReactWarning)?i.props.ref:i.props.ref||i.ref),c=function(e,t){let s={...t};for(let a in t){let r=e[a],l=t[a];/^on[A-Z]/.test(a)?r&&l?s[a]=(...e)=>{let t=l(...e);return r(...e),t}:r&&(s[a]=r):"style"===a?s[a]={...r,...l}:"className"===a&&(s[a]=[r,l].filter(Boolean).join(" "))}return{...e,...s}}(l,s.props);return s.type!==a.Fragment&&(c.ref=t?(0,r.t)(t,o):o),a.cloneElement(s,c)}return a.Children.count(s)>1?a.Children.only(null):null});return t.displayName=`${e}.SlotClone`,t}(e),s=a.forwardRef((e,s)=>{let{children:r,...i}=e,n=a.Children.toArray(r),o=n.find(c);if(o){let e=o.props.children,r=n.map(t=>t!==o?t:a.Children.count(e)>1?a.Children.only(null):a.isValidElement(e)?e.props.children:null);return(0,l.jsx)(t,{...i,ref:s,children:a.isValidElement(e)?a.cloneElement(e,void 0,r):null})}return(0,l.jsx)(t,{...i,ref:s,children:r})});return s.displayName=`${e}.Slot`,s}var n=i("Slot"),o=Symbol("radix.slottable");function c(e){return a.isValidElement(e)&&"function"==typeof e.type&&"__radixId"in e.type&&e.type.__radixId===o}},6845:(e,t,s)=>{"use strict";s.d(t,{$:()=>c});var a=s(4568),r=s(7620),l=s(6118),i=s(4616),n=s(826);let o=(0,i.F)("inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50",{variants:{variant:{default:"bg-primary text-primary-foreground shadow hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground shadow-sm hover:bg-destructive/90",outline:"border border-input bg-background shadow-sm hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground shadow-sm hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline",game:"bg-gradient-to-r from-primary to-primary/80 text-primary-foreground shadow-game hover:shadow-game/80 transform hover:scale-105 transition-all duration-200",perfect:"bg-game-perfect text-white shadow-lg hover:bg-game-perfect/90 animate-pulse-game",great:"bg-game-great text-white shadow-lg hover:bg-game-great/90",good:"bg-game-good text-white shadow-lg hover:bg-game-good/90",miss:"bg-game-miss text-white shadow-lg hover:bg-game-miss/90"},size:{default:"h-9 px-4 py-2",sm:"h-8 rounded-md px-3 text-xs",lg:"h-10 rounded-md px-8",xl:"h-12 rounded-lg px-10 text-base",icon:"h-9 w-9",game:"h-12 px-6 py-3 text-base font-semibold"}},defaultVariants:{variant:"default",size:"default"}}),c=r.forwardRef((e,t)=>{let{className:s,variant:r,size:i,asChild:c=!1,...d}=e,u=c?l.DX:"button";return(0,a.jsx)(u,{className:(0,n.cn)(o({variant:r,size:i,className:s})),ref:t,...d})});c.displayName="Button"},6862:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(2068).A)("star",[["path",{d:"M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.123 2.123 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.123 2.123 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.122 2.122 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.122 2.122 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.122 2.122 0 0 0 1.597-1.16z",key:"r04s7s"}]])},7541:(e,t,s)=>{"use strict";var a=s(3041);s.o(a,"usePathname")&&s.d(t,{usePathname:function(){return a.usePathname}}),s.o(a,"useRouter")&&s.d(t,{useRouter:function(){return a.useRouter}})},8756:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(2068).A)("play",[["path",{d:"M5 5a2 2 0 0 1 3.008-1.728l11.997 6.998a2 2 0 0 1 .003 3.458l-12 7A2 2 0 0 1 5 19z",key:"10ikf1"}]])}},e=>{e.O(0,[28,587,18,358],()=>e(e.s=5464)),_N_E=e.O()}]);
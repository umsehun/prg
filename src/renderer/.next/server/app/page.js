(()=>{var a={};a.id=974,a.ids=[974],a.modules={178:(a,b,c)=>{Promise.resolve().then(c.bind(c,1208))},261:a=>{"use strict";a.exports=require("next/dist/shared/lib/router/utils/app-paths")},790:(a,b,c)=>{"use strict";c.r(b),c.d(b,{default:()=>c0});var d,e,f,g=c(8157),h=c(1768);let i=()=>(0,g.jsxs)("div",{className:"absolute inset-0 overflow-hidden",children:[(0,g.jsx)("div",{className:"absolute top-0 left-0 w-72 h-72 bg-theme-secondary rounded-full mix-blend-multiply filter blur-xl opacity-70 animate-blob"}),(0,g.jsx)("div",{className:"absolute top-0 right-0 w-72 h-72 bg-theme-accent rounded-full mix-blend-multiply filter blur-xl opacity-70 animate-blob animation-delay-2000"}),(0,g.jsx)("div",{className:"absolute bottom-0 left-1/4 w-72 h-72 bg-theme-primary rounded-full mix-blend-multiply filter blur-xl opacity-70 animate-blob animation-delay-4000"})]}),j=()=>(0,g.jsxs)("div",{className:"text-center",children:[(0,g.jsx)("h1",{className:"text-8xl md:text-9xl font-black mb-4 bg-clip-text text-transparent bg-gradient-to-r from-theme-secondary to-theme-accent animate-pulse",children:"PRG"}),(0,g.jsx)("p",{className:"text-xl md:text-2xl text-theme-text-light/80 mb-12 font-light",children:"A RHYTHM GAME EXPERIENCE"})]}),k=[{label:"Start Game",scene:"Select"},{label:".osz Import",scene:"OszImport"},{label:"Settings",scene:"Settings"}],l=({onNavigate:a})=>(0,g.jsxs)("div",{className:"min-h-screen bg-theme-bg text-theme-text-light flex flex-col items-center justify-center p-8 overflow-hidden relative",children:[(0,g.jsx)(i,{}),(0,g.jsxs)("div",{className:"relative z-10 flex flex-col items-center justify-center",children:[(0,g.jsx)(j,{}),(0,g.jsx)("div",{className:"space-y-6",children:k.map((b,c)=>(0,g.jsx)("button",{onClick:()=>a(b.scene),className:"group relative px-12 py-4 bg-theme-primary text-theme-text-light rounded-lg hover:bg-theme-primary/80 transition-all duration-300 transform hover:scale-105 shadow-lg hover:shadow-xl",children:b.label},c))})]})]});class m{static async loadAudio(a){try{let b=window.electron,c=await b.loadAsset(a),d=new Blob([c],{type:"audio/ogg"});return URL.createObjectURL(d)}catch(b){throw console.error(`Failed to load audio asset: ${a}`,b),Error(`Failed to load audio: ${a}`)}}static async loadImage(a){try{let b=window.electron,c=await b.loadAsset(a),d=new Blob([c],{type:"image/png"});return URL.createObjectURL(d)}catch(b){throw console.error(`Failed to load image asset: ${a}`,b),Error(`Failed to load image: ${a}`)}}static async exists(a){try{let b=window.electron;return await b.assetExists(a)}catch(b){return console.error(`Failed to check asset existence: ${a}`,b),!1}}static cleanup(a){a.startsWith("blob:")&&URL.revokeObjectURL(a)}}let n=({bannerPath:a,title:b})=>{let[c,d]=(0,h.useState)(null),[e,f]=(0,h.useState)(!0),[i,j]=(0,h.useState)(null);return((0,h.useEffect)(()=>((async()=>{try{f(!0),j(null);let b=a.replace("/assets/",""),c=await m.loadImage(b);d(c)}catch(b){console.error(`Failed to load banner image: ${a}`,b),j("Failed to load image")}finally{f(!1)}})(),()=>{c&&m.cleanup(c)}),[a]),e)?(0,g.jsx)("div",{className:"w-full h-full flex items-center justify-center bg-gray-800",children:(0,g.jsx)("div",{className:"text-white",children:"Loading..."})}):i||!c?(0,g.jsx)("div",{className:"w-full h-full flex items-center justify-center bg-gray-800",children:(0,g.jsx)("div",{className:"text-white/70",children:"No Image"})}):(0,g.jsx)("img",{src:c,alt:b,className:"w-full h-full object-cover"})},o=a=>{let b,c=new Set,d=(a,d)=>{let e="function"==typeof a?a(b):a;if(!Object.is(e,b)){let a=b;b=(null!=d?d:"object"!=typeof e||null===e)?e:Object.assign({},b,e),c.forEach(c=>c(b,a))}},e=()=>b,f={setState:d,getState:e,getInitialState:()=>g,subscribe:a=>(c.add(a),()=>c.delete(a))},g=b=a(d,e,f);return f},p=a=>{let b=(a=>a?o(a):o)(a),c=a=>(function(a,b=a=>a){let c=h.useSyncExternalStore(a.subscribe,h.useCallback(()=>b(a.getState()),[a,b]),h.useCallback(()=>b(a.getInitialState()),[a,b]));return h.useDebugValue(c),c})(b,a);return Object.assign(c,b),c},q={score:0,combo:0,maxCombo:0,judgment:null,judgments:{KOOL:0,COOL:0,GOOD:0,MISS:0},currentScene:"Start",isPaused:!1,charts:[],selectedChartId:null,gameMode:"pin"},r=(a=>a?p(a):p)()((a,b)=>({...q,updateGame:c=>{let{combo:d,judgment:e}=c,f={...b().judgments};e&&e in f&&f[e]++,a(a=>({...c,maxCombo:Math.max(a.maxCombo,d??a.combo),judgments:f}))},setCurrentScene:b=>a({currentScene:b}),togglePause:()=>a(a=>({isPaused:!a.isPaused})),setSelectedChart:b=>a({selectedChartId:b}),setGameMode:b=>a({gameMode:b}),loadCharts:async()=>{if(b().charts.length>0)return;let c=await window.electron.discoverCharts();a({charts:c,selectedChartId:c[0]?.id??null})},reset:()=>a(q)})),s=()=>(0,g.jsxs)("div",{className:"absolute inset-0 overflow-hidden",children:[(0,g.jsx)("div",{className:"absolute -top-40 -right-40 w-80 h-80 bg-theme-secondary/10 rounded-full blur-3xl animate-pulse"}),(0,g.jsx)("div",{className:"absolute -bottom-40 -left-40 w-80 h-80 bg-theme-primary/10 rounded-full blur-3xl animate-pulse delay-1000"}),(0,g.jsx)("div",{className:"absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 w-96 h-96 bg-theme-accent/5 rounded-full blur-3xl animate-pulse delay-500"})]}),t=({onBack:a,onChartSelected:b})=>{let{charts:c,selectedChartId:d,setSelectedChart:e,setCurrentScene:f,loadCharts:i}=r();(0,h.useEffect)(()=>{i()},[]);let j=c.find(a=>a.id===d),k=async()=>{if(j)try{let a;(a=j.chartPath.endsWith(".osz")?await window.electron.convertOszToPinChart(j):await window.electron.loadPinChart(j.chartPath))&&b(a)}catch(a){console.error("Failed to load chart:",a)}};return(0,g.jsxs)("div",{className:"min-h-screen bg-theme-bg flex flex-col items-center justify-center p-8 text-theme-text-light",children:[(0,g.jsx)(s,{}),(0,g.jsxs)("div",{className:"w-full max-w-6xl h-[70vh] bg-black/30 backdrop-blur-lg rounded-2xl shadow-2xl border border-white/10 flex p-8 z-10",children:[(0,g.jsxs)("div",{className:"w-1/3 pr-6 border-r border-white/10 overflow-y-auto",children:[(0,g.jsx)("h2",{className:"text-3xl font-black mb-6 text-theme-accent",children:"SELECT MUSIC"}),(0,g.jsx)("div",{className:"space-y-2",children:c.map(a=>(0,g.jsxs)("button",{onClick:()=>e(a.id),className:`w-full text-left p-4 rounded-lg transition-all duration-200 ${d===a.id?"bg-theme-primary/30 border-l-4 border-theme-primary":"bg-white/5 hover:bg-white/10"}`,children:[(0,g.jsx)("p",{className:"font-bold text-lg",children:a.title}),(0,g.jsx)("p",{className:"text-sm text-white/60",children:a.artist})]},a.id))})]}),(0,g.jsxs)("div",{className:"w-2/3 pl-8 flex flex-col justify-between",children:[j?(0,g.jsxs)("div",{className:"flex-grow flex flex-col items-center justify-center text-center",children:[(0,g.jsx)("div",{className:"relative w-full max-w-lg h-48 rounded-lg shadow-lg mb-8 border-2 border-white/20 overflow-hidden",children:(0,g.jsx)(n,{bannerPath:j.bannerPath||"",title:j.title})}),(0,g.jsx)("h1",{className:"text-5xl font-extrabold tracking-tight",children:j.title}),(0,g.jsx)("p",{className:"text-2xl text-white/70 mt-2",children:j.artist})]}):(0,g.jsx)("div",{className:"flex-grow flex items-center justify-center",children:(0,g.jsx)("p",{className:"text-2xl",children:"Select a song"})}),(0,g.jsxs)("div",{className:"flex justify-between items-center",children:[(0,g.jsx)("button",{onClick:a,className:"px-6 py-3 bg-theme-secondary text-white rounded-lg hover:bg-theme-secondary/80 transition-colors",children:"Back to Menu"}),(0,g.jsx)("button",{onClick:k,disabled:!j,className:"px-12 py-4 text-2xl font-bold bg-theme-accent rounded-lg hover:bg-opacity-80 transition-all disabled:bg-gray-600 disabled:cursor-not-allowed transform hover:scale-105",children:"GAME START"})]})]})]})]})};var u=K(),v=a=>G(a,u),w=K();v.write=a=>G(a,w);var x=K();v.onStart=a=>G(a,x);var y=K();v.onFrame=a=>G(a,y);var z=K();v.onFinish=a=>G(a,z);var A=[];v.setTimeout=(a,b)=>{let c=v.now()+b,d=()=>{let a=A.findIndex(a=>a.cancel==d);~a&&A.splice(a,1),E-=!!~a},e={time:c,handler:a,cancel:d};return A.splice(B(c),0,e),E+=1,H(),e};var B=a=>~(~A.findIndex(b=>b.time>a)||~A.length);v.cancel=a=>{x.delete(a),y.delete(a),z.delete(a),u.delete(a),w.delete(a)},v.sync=a=>{F=!0,v.batchedUpdates(a),F=!1},v.throttle=a=>{let b;function c(){try{a(...b)}finally{b=null}}function d(...a){b=a,v.onStart(c)}return d.handler=a,d.cancel=()=>{x.delete(c),b=null},d};var C="undefined"!=typeof window?window.requestAnimationFrame:()=>{};v.use=a=>C=a,v.now="undefined"!=typeof performance?()=>performance.now():Date.now,v.batchedUpdates=a=>a(),v.catch=console.error,v.frameLoop="always",v.advance=()=>{"demand"!==v.frameLoop?console.warn("Cannot call the manual advancement of rafz whilst frameLoop is not set as demand"):J()};var D=-1,E=0,F=!1;function G(a,b){F?(b.delete(a),a(0)):(b.add(a),H())}function H(){D<0&&(D=0,"demand"!==v.frameLoop&&C(I))}function I(){~D&&(C(I),v.batchedUpdates(J))}function J(){let a=D,b=B(D=v.now());if(b&&(L(A.splice(0,b),a=>a.handler()),E-=b),!E)return void(D=-1);x.flush(),u.flush(a?Math.min(64,D-a):16.667),y.flush(),w.flush(),z.flush()}function K(){let a=new Set,b=a;return{add(c){E+=+!(b!=a||a.has(c)),a.add(c)},delete:c=>(E-=b==a&&a.has(c)?1:0,a.delete(c)),flush(c){b.size&&(a=new Set,E-=b.size,L(b,b=>b(c)&&a.add(b)),E+=a.size,b=a)}}}function L(a,b){a.forEach(a=>{try{b(a)}catch(a){v.catch(a)}})}var M=Object.defineProperty,N={};function O(){}((a,b)=>{for(var c in b)M(a,c,{get:b[c],enumerable:!0})})(N,{assign:()=>$,colors:()=>X,createStringInterpolator:()=>d,skipAnimation:()=>Y,to:()=>e,willAdvance:()=>Z});var P={arr:Array.isArray,obj:a=>!!a&&"Object"===a.constructor.name,fun:a=>"function"==typeof a,str:a=>"string"==typeof a,num:a=>"number"==typeof a,und:a=>void 0===a};function Q(a,b){if(P.arr(a)){if(!P.arr(b)||a.length!==b.length)return!1;for(let c=0;c<a.length;c++)if(a[c]!==b[c])return!1;return!0}return a===b}var R=(a,b)=>a.forEach(b);function S(a,b,c){if(P.arr(a)){for(let d=0;d<a.length;d++)b.call(c,a[d],`${d}`);return}for(let d in a)a.hasOwnProperty(d)&&b.call(c,a[d],d)}var T=a=>P.und(a)?[]:P.arr(a)?a:[a];function U(a,b){if(a.size){let c=Array.from(a);a.clear(),R(c,b)}}var V=(a,...b)=>U(a,a=>a(...b)),W=()=>"undefined"==typeof window||!window.navigator||/ServerSideRendering|^Deno\//.test(window.navigator.userAgent),X=null,Y=!1,Z=O,$=a=>{a.to&&(e=a.to),a.now&&(v.now=a.now),void 0!==a.colors&&(X=a.colors),null!=a.skipAnimation&&(Y=a.skipAnimation),a.createStringInterpolator&&(d=a.createStringInterpolator),a.requestAnimationFrame&&v.use(a.requestAnimationFrame),a.batchedUpdates&&(v.batchedUpdates=a.batchedUpdates),a.willAdvance&&(Z=a.willAdvance),a.frameLoop&&(v.frameLoop=a.frameLoop)},_=new Set,aa=[],ab=[],ac=0,ad={get idle(){return!_.size&&!aa.length},start(a){ac>a.priority?(_.add(a),v.onStart(ae)):(af(a),v(ah))},advance:ah,sort(a){if(ac)v.onFrame(()=>ad.sort(a));else{let b=aa.indexOf(a);~b&&(aa.splice(b,1),ag(a))}},clear(){aa=[],_.clear()}};function ae(){_.forEach(af),_.clear(),v(ah)}function af(a){aa.includes(a)||ag(a)}function ag(a){aa.splice(function(a,b){let c=a.findIndex(b);return c<0?a.length:c}(aa,b=>b.priority>a.priority),0,a)}function ah(a){let b=ab;for(let c=0;c<aa.length;c++){let d=aa[c];ac=d.priority,!d.idle&&(Z(d),d.advance(a),d.idle||b.push(d))}return ac=0,(ab=aa).length=0,(aa=b).length>0}var ai="[-+]?\\d*\\.?\\d+",aj=ai+"%";function ak(...a){return"\\(\\s*("+a.join(")\\s*,\\s*(")+")\\s*\\)"}var al=RegExp("rgb"+ak(ai,ai,ai)),am=RegExp("rgba"+ak(ai,ai,ai,ai)),an=RegExp("hsl"+ak(ai,aj,aj)),ao=RegExp("hsla"+ak(ai,aj,aj,ai)),ap=/^#([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,aq=/^#([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,ar=/^#([0-9a-fA-F]{6})$/,as=/^#([0-9a-fA-F]{8})$/;function at(a,b,c){return(c<0&&(c+=1),c>1&&(c-=1),c<1/6)?a+(b-a)*6*c:c<.5?b:c<2/3?a+(b-a)*(2/3-c)*6:a}function au(a,b,c){let d=c<.5?c*(1+b):c+b-c*b,e=2*c-d,f=at(e,d,a+1/3);return Math.round(255*f)<<24|Math.round(255*at(e,d,a))<<16|Math.round(255*at(e,d,a-1/3))<<8}function av(a){let b=parseInt(a,10);return b<0?0:b>255?255:b}function aw(a){return(parseFloat(a)%360+360)%360/360}function ax(a){let b=parseFloat(a);return b<0?0:b>1?255:Math.round(255*b)}function ay(a){let b=parseFloat(a);return b<0?0:b>100?1:b/100}function az(a){let b,c="number"==typeof a?a>>>0===a&&a>=0&&a<=0xffffffff?a:null:(b=ar.exec(a))?parseInt(b[1]+"ff",16)>>>0:X&&void 0!==X[a]?X[a]:(b=al.exec(a))?(av(b[1])<<24|av(b[2])<<16|av(b[3])<<8|255)>>>0:(b=am.exec(a))?(av(b[1])<<24|av(b[2])<<16|av(b[3])<<8|ax(b[4]))>>>0:(b=ap.exec(a))?parseInt(b[1]+b[1]+b[2]+b[2]+b[3]+b[3]+"ff",16)>>>0:(b=as.exec(a))?parseInt(b[1],16)>>>0:(b=aq.exec(a))?parseInt(b[1]+b[1]+b[2]+b[2]+b[3]+b[3]+b[4]+b[4],16)>>>0:(b=an.exec(a))?(255|au(aw(b[1]),ay(b[2]),ay(b[3])))>>>0:(b=ao.exec(a))?(au(aw(b[1]),ay(b[2]),ay(b[3]))|ax(b[4]))>>>0:null;if(null===c)return a;let d=(0xff000000&(c=c||0))>>>24,e=(0xff0000&c)>>>16,f=(65280&c)>>>8,g=(255&c)/255;return`rgba(${d}, ${e}, ${f}, ${g})`}var aA=(a,b,c)=>{if(P.fun(a))return a;if(P.arr(a))return aA({range:a,output:b,extrapolate:c});if(P.str(a.output[0]))return d(a);let e=a.output,f=a.range||[0,1],g=a.extrapolateLeft||a.extrapolate||"extend",h=a.extrapolateRight||a.extrapolate||"extend",i=a.easing||(a=>a);return b=>{let c=function(a,b){for(var c=1;c<b.length-1&&!(b[c]>=a);++c);return c-1}(b,f);return function(a,b,c,d,e,f,g,h,i){let j=i?i(a):a;if(j<b)if("identity"===g)return j;else"clamp"===g&&(j=b);if(j>c)if("identity"===h)return j;else"clamp"===h&&(j=c);return d===e?d:b===c?a<=b?d:e:(b===-1/0?j=-j:c===1/0?j-=b:j=(j-b)/(c-b),j=f(j),d===-1/0?j=-j:e===1/0?j+=d:j=j*(e-d)+d,j)}(b,f[c],f[c+1],e[c],e[c+1],i,g,h,a.map)}},aB=Symbol.for("FluidValue.get"),aC=Symbol.for("FluidValue.observers"),aD=a=>!!(a&&a[aB]),aE=a=>a&&a[aB]?a[aB]():a,aF=a=>a[aC]||null;function aG(a,b){let c=a[aC];c&&c.forEach(a=>{a.eventObserved?a.eventObserved(b):a(b)})}var aH=class{constructor(a){if(!a&&!(a=this.get))throw Error("Unknown getter");aI(this,a)}},aI=(a,b)=>aL(a,aB,b);function aJ(a,b){if(a[aB]){let c=a[aC];c||aL(a,aC,c=new Set),!c.has(b)&&(c.add(b),a.observerAdded&&a.observerAdded(c.size,b))}return b}function aK(a,b){let c=a[aC];if(c&&c.has(b)){let d=c.size-1;d?c.delete(b):a[aC]=null,a.observerRemoved&&a.observerRemoved(d,b)}}var aL=(a,b,c)=>Object.defineProperty(a,b,{value:c,writable:!0,configurable:!0}),aM=/[+\-]?(?:0|[1-9]\d*)(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,aN=/(#(?:[0-9a-f]{2}){2,4}|(#[0-9a-f]{3})|(rgb|hsl)a?\((-?\d+%?[,\s]+){2,3}\s*[\d\.]+%?\))/gi,aO=RegExp(`(${aM.source})(%|[a-z]+)`,"i"),aP=/rgba\(([0-9\.-]+), ([0-9\.-]+), ([0-9\.-]+), ([0-9\.-]+)\)/gi,aQ=/var\((--[a-zA-Z0-9-_]+),? ?([a-zA-Z0-9 ()%#.,-]+)?\)/,aR=a=>{let[b,c]=aS(a);if(!b||W())return a;let d=window.getComputedStyle(document.documentElement).getPropertyValue(b);if(d)return d.trim();if(c&&c.startsWith("--")){let a=window.getComputedStyle(document.documentElement).getPropertyValue(c);if(a)return a}else if(c&&aQ.test(c))return aR(c);else if(c)return c;return a},aS=a=>{let b=aQ.exec(a);if(!b)return[,];let[,c,d]=b;return[c,d]},aT=(a,b,c,d,e)=>`rgba(${Math.round(b)}, ${Math.round(c)}, ${Math.round(d)}, ${e})`,aU=a=>{f||(f=X?RegExp(`(${Object.keys(X).join("|")})(?!\\w)`,"g"):/^\b$/);let b=a.output.map(a=>aE(a).replace(aQ,aR).replace(aN,az).replace(f,az)),c=b.map(a=>a.match(aM).map(Number)),d=c[0].map((a,b)=>c.map(a=>{if(!(b in a))throw Error('The arity of each "output" value must be equal');return a[b]})).map(b=>aA({...a,output:b}));return a=>{let c=!aO.test(b[0])&&b.find(a=>aO.test(a))?.replace(aM,""),e=0;return b[0].replace(aM,()=>`${d[e++](a)}${c||""}`).replace(aP,aT)}},aV="react-spring: ",aW=a=>{let b=!1;if("function"!=typeof a)throw TypeError(`${aV}once requires a function parameter`);return(...c)=>{b||(a(...c),b=!0)}},aX=aW(console.warn),aY=aW(console.warn);function aZ(a){return P.str(a)&&("#"==a[0]||/\d/.test(a)||!W()&&aQ.test(a)||a in(X||{}))}var a$=W()?h.useEffect:h.useLayoutEffect;function a_(){let a=(0,h.useState)()[1],b=(()=>{let a=(0,h.useRef)(!1);return a$(()=>(a.current=!0,()=>{a.current=!1}),[]),a})();return()=>{b.current&&a(Math.random())}}var a0=a=>(0,h.useEffect)(a,a1),a1=[];function a2(a){let b=(0,h.useRef)(void 0);return(0,h.useEffect)(()=>{b.current=a}),b.current}var a3=Symbol.for("Animated:node"),a4=a=>a&&a[a3],a5=(a,b)=>Object.defineProperty(a,a3,{value:b,writable:!0,configurable:!0}),a6=a=>a&&a[a3]&&a[a3].getPayload(),a7=class{constructor(){a5(this,this)}getPayload(){return this.payload||[]}},a8=class a extends a7{constructor(a){super(),this._value=a,this.done=!0,this.durationProgress=0,P.num(this._value)&&(this.lastPosition=this._value)}static create(b){return new a(b)}getPayload(){return[this]}getValue(){return this._value}setValue(a,b){return P.num(a)&&(this.lastPosition=a,b&&(a=Math.round(a/b)*b,this.done&&(this.lastPosition=a))),this._value!==a&&(this._value=a,!0)}reset(){let{done:a}=this;this.done=!1,P.num(this._value)&&(this.elapsedTime=0,this.durationProgress=0,this.lastPosition=this._value,a&&(this.lastVelocity=null),this.v0=null)}},a9=class a extends a8{constructor(a){super(0),this._string=null,this._toString=aA({output:[a,a]})}static create(b){return new a(b)}getValue(){let a=this._string;return null==a?this._string=this._toString(this._value):a}setValue(a){if(P.str(a)){if(a==this._string)return!1;this._string=a,this._value=1}else{if(!super.setValue(a))return!1;this._string=null}return!0}reset(a){a&&(this._toString=aA({output:[this.getValue(),a]})),this._value=0,super.reset()}},ba={dependencies:null},bb=class extends a7{constructor(a){super(),this.source=a,this.setValue(a)}getValue(a){let b={};return S(this.source,(c,d)=>{c&&c[a3]===c?b[d]=c.getValue(a):aD(c)?b[d]=aE(c):a||(b[d]=c)}),b}setValue(a){this.source=a,this.payload=this._makePayload(a)}reset(){this.payload&&R(this.payload,a=>a.reset())}_makePayload(a){if(a){let b=new Set;return S(a,this._addToPayload,b),Array.from(b)}}_addToPayload(a){ba.dependencies&&aD(a)&&ba.dependencies.add(a);let b=a6(a);b&&R(b,a=>this.add(a))}},bc=class a extends bb{constructor(a){super(a)}static create(b){return new a(b)}getValue(){return this.source.map(a=>a.getValue())}setValue(a){let b=this.getPayload();return a.length==b.length?b.map((b,c)=>b.setValue(a[c])).some(Boolean):(super.setValue(a.map(bd)),!0)}};function bd(a){return(aZ(a)?a9:a8).create(a)}function be(a){let b=a4(a);return b?b.constructor:P.arr(a)?bc:aZ(a)?a9:a8}var bf=(a,b)=>{let c=!P.fun(a)||a.prototype&&a.prototype.isReactComponent;return(0,h.forwardRef)((d,e)=>{let f=(0,h.useRef)(null),g=c&&(0,h.useCallback)(a=>{f.current=function(a,b){return a&&(P.fun(a)?a(b):a.current=b),b}(e,a)},[e]),[i,j]=function(a,b){let c=new Set;return ba.dependencies=c,a.style&&(a={...a,style:b.createAnimatedStyle(a.style)}),a=new bb(a),ba.dependencies=null,[a,c]}(d,b),k=a_(),l=()=>{let a=f.current;(!c||a)&&!1===(!!a&&b.applyAnimatedValues(a,i.getValue(!0)))&&k()},m=new bg(l,j),n=(0,h.useRef)(void 0);a$(()=>(n.current=m,R(j,a=>aJ(a,m)),()=>{n.current&&(R(n.current.deps,a=>aK(a,n.current)),v.cancel(n.current.update))})),(0,h.useEffect)(l,[]),a0(()=>()=>{let a=n.current;R(a.deps,b=>aK(b,a))});let o=b.getComponentProps(i.getValue());return h.createElement(a,{...o,ref:g})})},bg=class{constructor(a,b){this.update=a,this.deps=b}eventObserved(a){"change"==a.type&&v.write(this.update)}},bh=Symbol.for("AnimatedComponent"),bi=a=>P.str(a)?a:a&&P.str(a.displayName)?a.displayName:P.fun(a)&&a.name||null;function bj(a,...b){return P.fun(a)?a(...b):a}var bk=(a,b)=>!0===a||!!(b&&a&&(P.fun(a)?a(b):T(a).includes(b))),bl=(a,b)=>P.obj(a)?b&&a[b]:a,bm=(a,b)=>!0===a.default?a[b]:a.default?a.default[b]:void 0,bn=a=>a,bo=(a,b=bn)=>{let c=bp;a.default&&!0!==a.default&&(c=Object.keys(a=a.default));let d={};for(let e of c){let c=b(a[e],e);P.und(c)||(d[e]=c)}return d},bp=["config","onProps","onStart","onChange","onPause","onResume","onRest"],bq={config:1,from:1,to:1,ref:1,loop:1,reset:1,pause:1,cancel:1,reverse:1,immediate:1,default:1,delay:1,onProps:1,onStart:1,onChange:1,onPause:1,onResume:1,onRest:1,onResolve:1,items:1,trail:1,sort:1,expires:1,initial:1,enter:1,update:1,leave:1,children:1,onDestroyed:1,keys:1,callId:1,parentId:1};function br(a){let b=function(a){let b={},c=0;if(S(a,(a,d)=>{!bq[d]&&(b[d]=a,c++)}),c)return b}(a);if(b){let c={to:b};return S(a,(a,d)=>d in b||(c[d]=a)),c}return{...a}}function bs(a){return a=aE(a),P.arr(a)?a.map(bs):aZ(a)?N.createStringInterpolator({range:[0,1],output:[a,a]})(1):a}function bt(a){for(let b in a)return!0;return!1}function bu(a){return P.fun(a)||P.arr(a)&&P.obj(a[0])}function bv(a,b){a.ref?.delete(a),b?.delete(a)}function bw(a,b){b&&a.ref!==b&&(a.ref?.delete(a),b.add(a),a.ref=b)}var bx={tension:170,friction:26,mass:1,damping:1,easing:a=>a,clamp:!1},by=class{constructor(){this.velocity=0,Object.assign(this,bx)}};function bz(a,b){if(P.und(b.decay)){let c=!P.und(b.tension)||!P.und(b.friction);!c&&P.und(b.frequency)&&P.und(b.damping)&&P.und(b.mass)||(a.duration=void 0,a.decay=void 0),c&&(a.frequency=void 0)}else a.duration=void 0}var bA=[],bB=class{constructor(){this.changed=!1,this.values=bA,this.toValues=null,this.fromValues=bA,this.config=new by,this.immediate=!1}};function bC(a,{key:b,props:c,defaultProps:d,state:e,actions:f}){return new Promise((g,h)=>{let i,j,k=bk(c.cancel??d?.cancel,b);if(k)n();else{P.und(c.pause)||(e.paused=bk(c.pause,b));let a=d?.pause;!0!==a&&(a=e.paused||bk(a,b)),i=bj(c.delay||0,b),a?(e.resumeQueue.add(m),f.pause()):(f.resume(),m())}function l(){e.resumeQueue.add(m),e.timeouts.delete(j),j.cancel(),i=j.time-v.now()}function m(){i>0&&!N.skipAnimation?(e.delayed=!0,j=v.setTimeout(n,i),e.pauseQueue.add(l),e.timeouts.add(j)):n()}function n(){e.delayed&&(e.delayed=!1),e.pauseQueue.delete(l),e.timeouts.delete(j),a<=(e.cancelId||0)&&(k=!0);try{f.start({...c,callId:a,cancel:k},g)}catch(a){h(a)}}})}var bD=(a,b)=>1==b.length?b[0]:b.some(a=>a.cancelled)?bG(a.get()):b.every(a=>a.noop)?bE(a.get()):bF(a.get(),b.every(a=>a.finished)),bE=a=>({value:a,noop:!0,finished:!0,cancelled:!1}),bF=(a,b,c=!1)=>({value:a,finished:b,cancelled:c}),bG=a=>({value:a,cancelled:!0,finished:!1});function bH(a,b,c,d){let{callId:e,parentId:f,onRest:g}=b,{asyncTo:h,promise:i}=c;return f||a!==h||b.reset?c.promise=(async()=>{let j,k,l;c.asyncId=e,c.asyncTo=a;let m=bo(b,(a,b)=>"onRest"===b?void 0:a),n=new Promise((a,b)=>(j=a,k=b)),o=a=>{let b=e<=(c.cancelId||0)&&bG(d)||e!==c.asyncId&&bF(d,!1);if(b)throw a.result=b,k(a),a},p=(a,b)=>{let f=new bJ,g=new bK;return(async()=>{if(N.skipAnimation)throw bI(c),g.result=bF(d,!1),k(g),g;o(f);let h=P.obj(a)?{...a}:{...b,to:a};h.parentId=e,S(m,(a,b)=>{P.und(h[b])&&(h[b]=a)});let i=await d.start(h);return o(f),c.paused&&await new Promise(a=>{c.resumeQueue.add(a)}),i})()};if(N.skipAnimation)return bI(c),bF(d,!1);try{let b;b=P.arr(a)?(async a=>{for(let b of a)await p(b)})(a):Promise.resolve(a(p,d.stop.bind(d))),await Promise.all([b.then(j),n]),l=bF(d.get(),!0,!1)}catch(a){if(a instanceof bJ)l=a.result;else if(a instanceof bK)l=a.result;else throw a}finally{e==c.asyncId&&(c.asyncId=f,c.asyncTo=f?h:void 0,c.promise=f?i:void 0)}return P.fun(g)&&v.batchedUpdates(()=>{g(l,d,d.item)}),l})():i}function bI(a,b){U(a.timeouts,a=>a.cancel()),a.pauseQueue.clear(),a.resumeQueue.clear(),a.asyncId=a.asyncTo=a.promise=void 0,b&&(a.cancelId=b)}var bJ=class extends Error{constructor(){super("An async animation has been interrupted. You see this error because you forgot to use `await` or `.catch(...)` on its returned promise.")}},bK=class extends Error{constructor(){super("SkipAnimationSignal")}},bL=1,bM=class extends aH{constructor(){super(...arguments),this.id=bL++,this._priority=0}get priority(){return this._priority}set priority(a){this._priority!=a&&(this._priority=a,this._onPriorityChange(a))}get(){let a=a4(this);return a&&a.getValue()}to(...a){return N.to(this,a)}interpolate(...a){return aX(`${aV}The "interpolate" function is deprecated in v9 (use "to" instead)`),N.to(this,a)}toJSON(){return this.get()}observerAdded(a){1==a&&this._attach()}observerRemoved(a){0==a&&this._detach()}_attach(){}_detach(){}_onChange(a,b=!1){aG(this,{type:"change",parent:this,value:a,idle:b})}_onPriorityChange(a){this.idle||ad.sort(this),aG(this,{type:"priority",parent:this,priority:a})}},bN=Symbol.for("SpringPhase"),bO=a=>(1&a[bN])>0,bP=a=>(2&a[bN])>0,bQ=a=>(4&a[bN])>0,bR=(a,b)=>b?a[bN]|=3:a[bN]&=-3,bS=(a,b)=>b?a[bN]|=4:a[bN]&=-5,bT=class extends bM{constructor(a,b){if(super(),this.animation=new bB,this.defaultProps={},this._state={paused:!1,delayed:!1,pauseQueue:new Set,resumeQueue:new Set,timeouts:new Set},this._pendingCalls=new Set,this._lastCallId=0,this._lastToId=0,this._memoizedDuration=0,!P.und(a)||!P.und(b)){let c=P.obj(a)?{...a}:{...b,from:a};P.und(c.default)&&(c.default=!0),this.start(c)}}get idle(){return!(bP(this)||this._state.asyncTo)||bQ(this)}get goal(){return aE(this.animation.to)}get velocity(){let a=a4(this);return a instanceof a8?a.lastVelocity||0:a.getPayload().map(a=>a.lastVelocity||0)}get hasAnimated(){return bO(this)}get isAnimating(){return bP(this)}get isPaused(){return bQ(this)}get isDelayed(){return this._state.delayed}advance(a){let b=!0,c=!1,d=this.animation,{toValues:e}=d,{config:f}=d,g=a6(d.to);!g&&aD(d.to)&&(e=T(aE(d.to))),d.values.forEach((h,i)=>{if(h.done)return;let j=h.constructor==a9?1:g?g[i].lastPosition:e[i],k=d.immediate,l=j;if(!k){let b;if(l=h.lastPosition,f.tension<=0){h.done=!0;return}let c=h.elapsedTime+=a,e=d.fromValues[i],g=null!=h.v0?h.v0:h.v0=P.arr(f.velocity)?f.velocity[i]:f.velocity,m=f.precision||(e==j?.005:Math.min(1,.001*Math.abs(j-e)));if(P.und(f.duration))if(f.decay){let a=!0===f.decay?.998:f.decay,d=Math.exp(-(1-a)*c);l=e+g/(1-a)*(1-d),k=Math.abs(h.lastPosition-l)<=m,b=g*d}else{b=null==h.lastVelocity?g:h.lastVelocity;let c=f.restVelocity||m/10,d=f.clamp?0:f.bounce,i=!P.und(d),n=e==j?h.v0>0:e<j,o=Math.ceil(a/1);for(let a=0;a<o&&!(!(Math.abs(b)>c)&&(k=Math.abs(j-l)<=m));++a){i&&(l==j||l>j==n)&&(b=-b*d,l=j);let a=(-(1e-6*f.tension)*(l-j)+-(.001*f.friction)*b)/f.mass;b+=+a,l+=+b}}else{let d=1;f.duration>0&&(this._memoizedDuration!==f.duration&&(this._memoizedDuration=f.duration,h.durationProgress>0&&(h.elapsedTime=f.duration*h.durationProgress,c=h.elapsedTime+=a)),h.durationProgress=d=(d=(f.progress||0)+c/this._memoizedDuration)>1?1:d<0?0:d),b=((l=e+f.easing(d)*(j-e))-h.lastPosition)/a,k=1==d}h.lastVelocity=b,Number.isNaN(l)&&(console.warn("Got NaN while animating:",this),k=!0)}g&&!g[i].done&&(k=!1),k?h.done=!0:b=!1,h.setValue(l,f.round)&&(c=!0)});let h=a4(this),i=h.getValue();if(b){let a=aE(d.to);(i!==a||c)&&!f.decay?(h.setValue(a),this._onChange(a)):c&&f.decay&&this._onChange(i),this._stop()}else c&&this._onChange(i)}set(a){return v.batchedUpdates(()=>{this._stop(),this._focus(a),this._set(a)}),this}pause(){this._update({pause:!0})}resume(){this._update({pause:!1})}finish(){if(bP(this)){let{to:a,config:b}=this.animation;v.batchedUpdates(()=>{this._onStart(),b.decay||this._set(a,!1),this._stop()})}return this}update(a){return(this.queue||(this.queue=[])).push(a),this}start(a,b){let c;return P.und(a)?(c=this.queue||[],this.queue=[]):c=[P.obj(a)?a:{...b,to:a}],Promise.all(c.map(a=>this._update(a))).then(a=>bD(this,a))}stop(a){let{to:b}=this.animation;return this._focus(this.get()),bI(this._state,a&&this._lastCallId),v.batchedUpdates(()=>this._stop(b,a)),this}reset(){this._update({reset:!0})}eventObserved(a){"change"==a.type?this._start():"priority"==a.type&&(this.priority=a.priority+1)}_prepareNode(a){let b=this.key||"",{to:c,from:d}=a;(null==(c=P.obj(c)?c[b]:c)||bu(c))&&(c=void 0),null==(d=P.obj(d)?d[b]:d)&&(d=void 0);let e={to:c,from:d};return!bO(this)&&(a.reverse&&([c,d]=[d,c]),d=aE(d),P.und(d)?a4(this)||this._set(c):this._set(d)),e}_update({...a},b){let{key:c,defaultProps:d}=this;a.default&&Object.assign(d,bo(a,(a,b)=>/^on/.test(b)?bl(a,c):a)),bZ(this,a,"onProps"),b$(this,"onProps",a,this);let e=this._prepareNode(a);if(Object.isFrozen(this))throw Error("Cannot animate a `SpringValue` object that is frozen. Did you forget to pass your component to `animated(...)` before animating its props?");let f=this._state;return bC(++this._lastCallId,{key:c,props:a,defaultProps:d,state:f,actions:{pause:()=>{bQ(this)||(bS(this,!0),V(f.pauseQueue),b$(this,"onPause",bF(this,bU(this,this.animation.to)),this))},resume:()=>{bQ(this)&&(bS(this,!1),bP(this)&&this._resume(),V(f.resumeQueue),b$(this,"onResume",bF(this,bU(this,this.animation.to)),this))},start:this._merge.bind(this,e)}}).then(c=>{if(a.loop&&c.finished&&!(b&&c.noop)){let b=bV(a);if(b)return this._update(b,!0)}return c})}_merge(a,b,c){if(b.cancel)return this.stop(!0),c(bG(this));let d=!P.und(a.to),e=!P.und(a.from);if(d||e)if(!(b.callId>this._lastToId))return c(bG(this));else this._lastToId=b.callId;let{key:f,defaultProps:g,animation:h}=this,{to:i,from:j}=h,{to:k=i,from:l=j}=a;e&&!d&&(!b.default||P.und(k))&&(k=l),b.reverse&&([k,l]=[l,k]);let m=!Q(l,j);m&&(h.from=l),l=aE(l);let n=!Q(k,i);n&&this._focus(k);let o=bu(b.to),{config:p}=h,{decay:q,velocity:r}=p;(d||e)&&(p.velocity=0),b.config&&!o&&function(a,b,c){for(let d in c&&(bz(c={...c},b),b={...c,...b}),bz(a,b),Object.assign(a,b),bx)null==a[d]&&(a[d]=bx[d]);let{frequency:d,damping:e}=a,{mass:f}=a;P.und(d)||(d<.01&&(d=.01),e<0&&(e=0),a.tension=Math.pow(2*Math.PI/d,2)*f,a.friction=4*Math.PI*e*f/d)}(p,bj(b.config,f),b.config!==g.config?bj(g.config,f):void 0);let s=a4(this);if(!s||P.und(k))return c(bF(this,!0));let t=P.und(b.reset)?e&&!b.default:!P.und(l)&&bk(b.reset,f),u=t?l:this.get(),w=bs(k),x=P.num(w)||P.arr(w)||aZ(w),y=!o&&(!x||bk(g.immediate||b.immediate,f));if(n){let a=be(k);if(a!==s.constructor)if(y)s=this._set(w);else throw Error(`Cannot animate between ${s.constructor.name} and ${a.name}, as the "to" prop suggests`)}let z=s.constructor,A=aD(k),B=!1;if(!A){let a=t||!bO(this)&&m;(n||a)&&(A=!(B=Q(bs(u),w))),(Q(h.immediate,y)||y)&&Q(p.decay,q)&&Q(p.velocity,r)||(A=!0)}if(B&&bP(this)&&(h.changed&&!t?A=!0:A||this._stop(i)),!o&&((A||aD(i))&&(h.values=s.getPayload(),h.toValues=aD(k)?null:z==a9?[1]:T(w)),h.immediate!=y&&(h.immediate=y,y||t||this._set(i)),A)){let{onRest:a}=h;R(bY,a=>bZ(this,b,a));let d=bF(this,bU(this,i));V(this._pendingCalls,d),this._pendingCalls.add(c),h.changed&&v.batchedUpdates(()=>{h.changed=!t,a?.(d,this),t?bj(g.onRest,d):h.onStart?.(d,this)})}t&&this._set(u),o?c(bH(b.to,b,this._state,this)):A?this._start():bP(this)&&!n?this._pendingCalls.add(c):c(bE(u))}_focus(a){let b=this.animation;a!==b.to&&(aF(this)&&this._detach(),b.to=a,aF(this)&&this._attach())}_attach(){let a=0,{to:b}=this.animation;aD(b)&&(aJ(b,this),b instanceof bM&&(a=b.priority+1)),this.priority=a}_detach(){let{to:a}=this.animation;aD(a)&&aK(a,this)}_set(a,b=!0){let c=aE(a);if(!P.und(c)){let a=a4(this);if(!a||!Q(c,a.getValue())){let d=be(c);a&&a.constructor==d?a.setValue(c):a5(this,d.create(c)),a&&v.batchedUpdates(()=>{this._onChange(c,b)})}}return a4(this)}_onStart(){let a=this.animation;a.changed||(a.changed=!0,b$(this,"onStart",bF(this,bU(this,a.to)),this))}_onChange(a,b){b||(this._onStart(),bj(this.animation.onChange,a,this)),bj(this.defaultProps.onChange,a,this),super._onChange(a,b)}_start(){let a=this.animation;a4(this).reset(aE(a.to)),a.immediate||(a.fromValues=a.values.map(a=>a.lastPosition)),!bP(this)&&(bR(this,!0),bQ(this)||this._resume())}_resume(){N.skipAnimation?this.finish():ad.start(this)}_stop(a,b){if(bP(this)){bR(this,!1);let c=this.animation;R(c.values,a=>{a.done=!0}),c.toValues&&(c.onChange=c.onPause=c.onResume=void 0),aG(this,{type:"idle",parent:this});let d=b?bG(this.get()):bF(this.get(),bU(this,a??c.to));V(this._pendingCalls,d),c.changed&&(c.changed=!1,b$(this,"onRest",d,this))}}};function bU(a,b){let c=bs(b);return Q(bs(a.get()),c)}function bV(a,b=a.loop,c=a.to){let d=bj(b);if(d){let e=!0!==d&&br(d),f=(e||a).reverse,g=!e||e.reset;return bW({...a,loop:b,default:!1,pause:void 0,to:!f||bu(c)?c:void 0,from:g?a.from:void 0,reset:g,...e})}}function bW(a){let{to:b,from:c}=a=br(a),d=new Set;return P.obj(b)&&bX(b,d),P.obj(c)&&bX(c,d),a.keys=d.size?Array.from(d):null,a}function bX(a,b){S(a,(a,c)=>null!=a&&b.add(c))}var bY=["onStart","onRest","onChange","onPause","onResume"];function bZ(a,b,c){a.animation[c]=b[c]!==bm(b,c)?bl(b[c],a.key):void 0}function b$(a,b,...c){a.animation[b]?.(...c),a.defaultProps[b]?.(...c)}var b_=["onStart","onChange","onRest"],b0=1,b1=class{constructor(a,b){this.id=b0++,this.springs={},this.queue=[],this._lastAsyncId=0,this._active=new Set,this._changed=new Set,this._started=!1,this._state={paused:!1,pauseQueue:new Set,resumeQueue:new Set,timeouts:new Set},this._events={onStart:new Map,onChange:new Map,onRest:new Map},this._onFrame=this._onFrame.bind(this),b&&(this._flush=b),a&&this.start({default:!0,...a})}get idle(){return!this._state.asyncTo&&Object.values(this.springs).every(a=>a.idle&&!a.isDelayed&&!a.isPaused)}get item(){return this._item}set item(a){this._item=a}get(){let a={};return this.each((b,c)=>a[c]=b.get()),a}set(a){for(let b in a){let c=a[b];P.und(c)||this.springs[b].set(c)}}update(a){return a&&this.queue.push(bW(a)),this}start(a){let{queue:b}=this;return(a?b=T(a).map(bW):this.queue=[],this._flush)?this._flush(this,b):(b8(this,b),b2(this,b))}stop(a,b){if(!!a!==a&&(b=a),b){let c=this.springs;R(T(b),b=>c[b].stop(!!a))}else bI(this._state,this._lastAsyncId),this.each(b=>b.stop(!!a));return this}pause(a){if(P.und(a))this.start({pause:!0});else{let b=this.springs;R(T(a),a=>b[a].pause())}return this}resume(a){if(P.und(a))this.start({pause:!1});else{let b=this.springs;R(T(a),a=>b[a].resume())}return this}each(a){S(this.springs,a)}_onFrame(){let{onStart:a,onChange:b,onRest:c}=this._events,d=this._active.size>0,e=this._changed.size>0;(d&&!this._started||e&&!this._started)&&(this._started=!0,U(a,([a,b])=>{b.value=this.get(),a(b,this,this._item)}));let f=!d&&this._started,g=e||f&&c.size?this.get():null;e&&b.size&&U(b,([a,b])=>{b.value=g,a(b,this,this._item)}),f&&(this._started=!1,U(c,([a,b])=>{b.value=g,a(b,this,this._item)}))}eventObserved(a){if("change"==a.type)this._changed.add(a.parent),a.idle||this._active.add(a.parent);else{if("idle"!=a.type)return;this._active.delete(a.parent)}v.onFrame(this._onFrame)}};function b2(a,b){return Promise.all(b.map(b=>b3(a,b))).then(b=>bD(a,b))}async function b3(a,b,c){let{keys:d,to:e,from:f,loop:g,onRest:h,onResolve:i}=b,j=P.obj(b.default)&&b.default;g&&(b.loop=!1),!1===e&&(b.to=null),!1===f&&(b.from=null);let k=P.arr(e)||P.fun(e)?e:void 0;k?(b.to=void 0,b.onRest=void 0,j&&(j.onRest=void 0)):R(b_,c=>{let d=b[c];if(P.fun(d)){let e=a._events[c];b[c]=({finished:a,cancelled:b})=>{let c=e.get(d);c?(a||(c.finished=!1),b&&(c.cancelled=!0)):e.set(d,{value:null,finished:a||!1,cancelled:b||!1})},j&&(j[c]=b[c])}});let l=a._state;!l.paused===b.pause?(l.paused=b.pause,V(b.pause?l.pauseQueue:l.resumeQueue)):l.paused&&(b.pause=!0);let m=(d||Object.keys(a.springs)).map(c=>a.springs[c].start(b)),n=!0===b.cancel||!0===bm(b,"cancel");(k||n&&l.asyncId)&&m.push(bC(++a._lastAsyncId,{props:b,state:l,actions:{pause:O,resume:O,start(b,c){n?(bI(l,a._lastAsyncId),c(bG(a))):(b.onRest=h,c(bH(k,b,l,a)))}}})),l.paused&&await new Promise(a=>{l.resumeQueue.add(a)});let o=bD(a,await Promise.all(m));if(g&&o.finished&&!(c&&o.noop)){let c=bV(b,g,e);if(c)return b8(a,[c]),b3(a,c,!0)}return i&&v.batchedUpdates(()=>i(o,a,a.item)),o}function b4(a,b){let c={...a.springs};return b&&R(T(b),a=>{P.und(a.keys)&&(a=bW(a)),P.obj(a.to)||(a={...a,to:void 0}),b7(c,a,a=>b6(a))}),b5(a,c),c}function b5(a,b){S(b,(b,c)=>{a.springs[c]||(a.springs[c]=b,aJ(b,a))})}function b6(a,b){let c=new bT;return c.key=a,b&&aJ(c,b),c}function b7(a,b,c){b.keys&&R(b.keys,d=>{(a[d]||(a[d]=c(d)))._prepareNode(b)})}function b8(a,b){R(b,b=>{b7(a.springs,b,b=>b6(b,a))})}var b9=h.createContext({pause:!1,immediate:!1}),ca=()=>{let a=[],b=function(b){aY(`${aV}Directly calling start instead of using the api object is deprecated in v9 (use ".start" instead), this will be removed in later 0.X.0 versions`);let d=[];return R(a,(a,e)=>{if(P.und(b))d.push(a.start());else{let f=c(b,a,e);f&&d.push(a.start(f))}}),d};b.current=a,b.add=function(b){a.includes(b)||a.push(b)},b.delete=function(b){let c=a.indexOf(b);~c&&a.splice(c,1)},b.pause=function(){return R(a,a=>a.pause(...arguments)),this},b.resume=function(){return R(a,a=>a.resume(...arguments)),this},b.set=function(b){R(a,(a,c)=>{let d=P.fun(b)?b(c,a):b;d&&a.set(d)})},b.start=function(b){let c=[];return R(a,(a,d)=>{if(P.und(b))c.push(a.start());else{let e=this._getProps(b,a,d);e&&c.push(a.start(e))}}),c},b.stop=function(){return R(a,a=>a.stop(...arguments)),this},b.update=function(b){return R(a,(a,c)=>a.update(this._getProps(b,a,c))),this};let c=function(a,b,c){return P.fun(a)?a(c,b):a};return b._getProps=c,b};function cb(a,b,c){let d=P.fun(b)&&b;d&&!c&&(c=[]);let e=(0,h.useMemo)(()=>d||3==arguments.length?ca():void 0,[]),f=(0,h.useRef)(0),g=a_(),i=(0,h.useMemo)(()=>({ctrls:[],queue:[],flush(a,b){let c=b4(a,b);return!(f.current>0)||i.queue.length||Object.keys(c).some(b=>!a.springs[b])?new Promise(d=>{b5(a,c),i.queue.push(()=>{d(b2(a,b))}),g()}):b2(a,b)}}),[]),j=(0,h.useRef)([...i.ctrls]),k=(0,h.useRef)([]),l=a2(a)||0;function m(a,c){for(let e=a;e<c;e++){let a=j.current[e]||(j.current[e]=new b1(null,i.flush)),c=d?d(e,a):b[e];c&&(k.current[e]=function(a){let b=bW(a);return P.und(b.default)&&(b.default=bo(b)),b}(c))}}(0,h.useMemo)(()=>{R(j.current.slice(a,l),a=>{bv(a,e),a.stop(!0)}),j.current.length=a,m(l,a)},[a]),(0,h.useMemo)(()=>{m(0,Math.min(l,a))},c);let n=j.current.map((a,b)=>b4(a,k.current[b])),o=(0,h.useContext)(b9),p=a2(o),q=o!==p&&bt(o);a$(()=>{f.current++,i.ctrls=j.current;let{queue:a}=i;a.length&&(i.queue=[],R(a,a=>a())),R(j.current,(a,b)=>{e?.add(a),q&&a.start({default:o});let c=k.current[b];c&&(bw(a,c.ref),a.ref?a.queue.push(c):a.start(c))})}),a0(()=>()=>{R(i.ctrls,a=>a.stop(!0))});let r=n.map(a=>({...a}));return e?[r,e]:r}function cc(a,b){let c=P.fun(a),[[d],e]=cb(1,c?a:[a],c?b||[]:b);return c||2==arguments.length?[d,e]:d}function cd(a,b,c){let d=P.fun(b)&&b,{reset:e,sort:f,trail:g=0,expires:i=!0,exitBeforeEnter:j=!1,onDestroyed:k,ref:l,config:m}=d?d():b,n=(0,h.useMemo)(()=>d||3==arguments.length?ca():void 0,[]),o=T(a),p=[],q=(0,h.useRef)(null),r=e?null:q.current;a$(()=>{q.current=p}),a0(()=>(R(p,a=>{n?.add(a.ctrl),a.ctrl.ref=n}),()=>{R(q.current,a=>{a.expired&&clearTimeout(a.expirationId),bv(a.ctrl,n),a.ctrl.stop(!0)})}));let s=function(a,{key:b,keys:c=b},d){if(null===c){let b=new Set;return a.map(a=>{let c=d&&d.find(c=>c.item===a&&"leave"!==c.phase&&!b.has(c));return c?(b.add(c),c.key):ce++})}return P.und(c)?a:P.fun(c)?a.map(c):T(c)}(o,d?d():b,r),t=e&&q.current||[];a$(()=>R(t,({ctrl:a,item:b,key:c})=>{bv(a,n),bj(k,b,c)}));let u=[];if(r&&R(r,(a,b)=>{a.expired?(clearTimeout(a.expirationId),t.push(a)):~(b=u[b]=s.indexOf(a.key))&&(p[b]=a)}),R(o,(a,b)=>{p[b]||(p[b]={key:s[b],item:a,phase:"mount",ctrl:new b1},p[b].ctrl.item=a)}),u.length){let a=-1,{leave:c}=d?d():b;R(u,(b,d)=>{let e=r[d];~b?(a=p.indexOf(e),p[a]={...e,item:o[b]}):c&&p.splice(++a,0,e)})}P.fun(f)&&p.sort((a,b)=>f(a.item,b.item));let v=-g,w=a_(),x=bo(b),y=new Map,z=(0,h.useRef)(new Map),A=(0,h.useRef)(!1);R(p,(a,c)=>{let e,f,h=a.key,k=a.phase,n=d?d():b,o=bj(n.delay||0,h);if("mount"==k)e=n.enter,f="enter";else{let a=0>s.indexOf(h);if("leave"!=k)if(a)e=n.leave,f="leave";else{if(!(e=n.update))return;f="update"}else{if(a)return;e=n.enter,f="enter"}}if(e=bj(e,a.item,c),!(e=P.obj(e)?br(e):{to:e}).config){let b=m||x.config;e.config=bj(b,a.item,c,f)}v+=g;let p={...x,delay:o+v,ref:l,immediate:n.immediate,reset:!1,...e};if("enter"==f&&P.und(p.from)){let e=d?d():b;p.from=bj(P.und(e.initial)||r?e.from:e.initial,a.item,c)}let{onResolve:t}=p;p.onResolve=a=>{bj(t,a);let b=q.current,c=b.find(a=>a.key===h);if(c&&(!a.cancelled||"update"==c.phase)&&c.ctrl.idle){let a=b.every(a=>a.ctrl.idle);if("leave"==c.phase){let b=bj(i,c.item);if(!1!==b){let d=!0===b?0:b;if(c.expired=!0,!a&&d>0){d<=0x7fffffff&&(c.expirationId=setTimeout(w,d));return}}}a&&b.some(a=>a.expired)&&(z.current.delete(c),j&&(A.current=!0),w())}};let u=b4(a.ctrl,p);"leave"===f&&j?z.current.set(a,{phase:f,springs:u,payload:p}):y.set(a,{phase:f,springs:u,payload:p})});let B=(0,h.useContext)(b9),C=a2(B),D=B!==C&&bt(B);a$(()=>{D&&R(p,a=>{a.ctrl.start({default:B})})},[B]),R(y,(a,b)=>{if(z.current.size){let a=p.findIndex(a=>a.key===b.key);p.splice(a,1)}}),a$(()=>{R(z.current.size?z.current:y,({phase:a,payload:b},c)=>{let{ctrl:d}=c;c.phase=a,n?.add(d),D&&"enter"==a&&d.start({default:B}),b&&(bw(d,b.ref),(d.ref||n)&&!A.current?d.update(b):(d.start(b),A.current&&(A.current=!1)))})},e?void 0:c);let E=a=>h.createElement(h.Fragment,null,p.map((b,c)=>{let{springs:d}=y.get(b)||b.ctrl,e=a({...d},b.item,b,c);return e&&e.type?h.createElement(e.type,{...e.props,key:P.str(b.key)||P.num(b.key)?b.key:b.ctrl.id,ref:e.ref}):e}));return n?[E,n]:E}var ce=1,cf=class extends bM{constructor(a,b){super(),this.source=a,this.idle=!0,this._active=new Set,this.calc=aA(...b);let c=this._get();a5(this,be(c).create(c))}advance(a){let b=this._get();Q(b,this.get())||(a4(this).setValue(b),this._onChange(b,this.idle)),!this.idle&&ch(this._active)&&ci(this)}_get(){let a=P.arr(this.source)?this.source.map(aE):T(aE(this.source));return this.calc(...a)}_start(){this.idle&&!ch(this._active)&&(this.idle=!1,R(a6(this),a=>{a.done=!1}),N.skipAnimation?(v.batchedUpdates(()=>this.advance()),ci(this)):ad.start(this))}_attach(){let a=1;R(T(this.source),b=>{aD(b)&&aJ(b,this),b instanceof bM&&(b.idle||this._active.add(b),a=Math.max(a,b.priority+1))}),this.priority=a,this._start()}_detach(){R(T(this.source),a=>{aD(a)&&aK(a,this)}),this._active.clear(),ci(this)}eventObserved(a){"change"==a.type?a.idle?this.advance():(this._active.add(a.parent),this._start()):"idle"==a.type?this._active.delete(a.parent):"priority"==a.type&&(this.priority=T(this.source).reduce((a,b)=>Math.max(a,(b instanceof bM?b.priority:0)+1),0))}};function cg(a){return!1!==a.idle}function ch(a){return!a.size||Array.from(a).every(cg)}function ci(a){a.idle||(a.idle=!0,R(a6(a),a=>{a.done=!0}),aG(a,{type:"idle",parent:a}))}N.assign({createStringInterpolator:aU,to:(a,b)=>new cf(a,b)}),ad.advance;var cj=c(5081),ck=/^--/,cl={},cm={animationIterationCount:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},cn=["Webkit","Ms","Moz","O"];cm=Object.keys(cm).reduce((a,b)=>(cn.forEach(c=>a[((a,b)=>a+b.charAt(0).toUpperCase()+b.substring(1))(c,b)]=a[b]),a),cm);var co=/^(matrix|translate|scale|rotate|skew)/,cp=/^(translate)/,cq=/^(rotate|skew)/,cr=(a,b)=>P.num(a)&&0!==a?a+b:a,cs=(a,b)=>P.arr(a)?a.every(a=>cs(a,b)):P.num(a)?a===b:parseFloat(a)===b,ct=class extends bb{constructor({x:a,y:b,z:c,...d}){let e=[],f=[];(a||b||c)&&(e.push([a||0,b||0,c||0]),f.push(a=>[`translate3d(${a.map(a=>cr(a,"px")).join(",")})`,cs(a,0)])),S(d,(a,b)=>{if("transform"===b)e.push([a||""]),f.push(a=>[a,""===a]);else if(co.test(b)){if(delete d[b],P.und(a))return;let c=cp.test(b)?"px":cq.test(b)?"deg":"";e.push(T(a)),f.push("rotate3d"===b?([a,b,d,e])=>[`rotate3d(${a},${b},${d},${cr(e,c)})`,cs(e,0)]:a=>[`${b}(${a.map(a=>cr(a,c)).join(",")})`,cs(a,+!!b.startsWith("scale"))])}}),e.length&&(d.transform=new cu(e,f)),super(d)}},cu=class extends aH{constructor(a,b){super(),this.inputs=a,this.transforms=b,this._value=null}get(){return this._value||(this._value=this._get())}_get(){let a="",b=!0;return R(this.inputs,(c,d)=>{let e=aE(c[0]),[f,g]=this.transforms[d](P.arr(e)?e:c.map(aE));a+=" "+f,b=b&&g}),b?"none":a}observerAdded(a){1==a&&R(this.inputs,a=>R(a,a=>aD(a)&&aJ(a,this)))}observerRemoved(a){0==a&&R(this.inputs,a=>R(a,a=>aD(a)&&aK(a,this)))}eventObserved(a){"change"==a.type&&(this._value=null),aG(this,a)}};N.assign({batchedUpdates:cj.unstable_batchedUpdates,createStringInterpolator:aU,colors:{transparent:0,aliceblue:0xf0f8ffff,antiquewhite:0xfaebd7ff,aqua:0xffffff,aquamarine:0x7fffd4ff,azure:0xf0ffffff,beige:0xf5f5dcff,bisque:0xffe4c4ff,black:255,blanchedalmond:0xffebcdff,blue:65535,blueviolet:0x8a2be2ff,brown:0xa52a2aff,burlywood:0xdeb887ff,burntsienna:0xea7e5dff,cadetblue:0x5f9ea0ff,chartreuse:0x7fff00ff,chocolate:0xd2691eff,coral:0xff7f50ff,cornflowerblue:0x6495edff,cornsilk:0xfff8dcff,crimson:0xdc143cff,cyan:0xffffff,darkblue:35839,darkcyan:9145343,darkgoldenrod:0xb8860bff,darkgray:0xa9a9a9ff,darkgreen:6553855,darkgrey:0xa9a9a9ff,darkkhaki:0xbdb76bff,darkmagenta:0x8b008bff,darkolivegreen:0x556b2fff,darkorange:0xff8c00ff,darkorchid:0x9932ccff,darkred:0x8b0000ff,darksalmon:0xe9967aff,darkseagreen:0x8fbc8fff,darkslateblue:0x483d8bff,darkslategray:0x2f4f4fff,darkslategrey:0x2f4f4fff,darkturquoise:0xced1ff,darkviolet:0x9400d3ff,deeppink:0xff1493ff,deepskyblue:0xbfffff,dimgray:0x696969ff,dimgrey:0x696969ff,dodgerblue:0x1e90ffff,firebrick:0xb22222ff,floralwhite:0xfffaf0ff,forestgreen:0x228b22ff,fuchsia:0xff00ffff,gainsboro:0xdcdcdcff,ghostwhite:0xf8f8ffff,gold:0xffd700ff,goldenrod:0xdaa520ff,gray:0x808080ff,green:8388863,greenyellow:0xadff2fff,grey:0x808080ff,honeydew:0xf0fff0ff,hotpink:0xff69b4ff,indianred:0xcd5c5cff,indigo:0x4b0082ff,ivory:0xfffff0ff,khaki:0xf0e68cff,lavender:0xe6e6faff,lavenderblush:0xfff0f5ff,lawngreen:0x7cfc00ff,lemonchiffon:0xfffacdff,lightblue:0xadd8e6ff,lightcoral:0xf08080ff,lightcyan:0xe0ffffff,lightgoldenrodyellow:0xfafad2ff,lightgray:0xd3d3d3ff,lightgreen:0x90ee90ff,lightgrey:0xd3d3d3ff,lightpink:0xffb6c1ff,lightsalmon:0xffa07aff,lightseagreen:0x20b2aaff,lightskyblue:0x87cefaff,lightslategray:0x778899ff,lightslategrey:0x778899ff,lightsteelblue:0xb0c4deff,lightyellow:0xffffe0ff,lime:0xff00ff,limegreen:0x32cd32ff,linen:0xfaf0e6ff,magenta:0xff00ffff,maroon:0x800000ff,mediumaquamarine:0x66cdaaff,mediumblue:52735,mediumorchid:0xba55d3ff,mediumpurple:0x9370dbff,mediumseagreen:0x3cb371ff,mediumslateblue:0x7b68eeff,mediumspringgreen:0xfa9aff,mediumturquoise:0x48d1ccff,mediumvioletred:0xc71585ff,midnightblue:0x191970ff,mintcream:0xf5fffaff,mistyrose:0xffe4e1ff,moccasin:0xffe4b5ff,navajowhite:0xffdeadff,navy:33023,oldlace:0xfdf5e6ff,olive:0x808000ff,olivedrab:0x6b8e23ff,orange:0xffa500ff,orangered:0xff4500ff,orchid:0xda70d6ff,palegoldenrod:0xeee8aaff,palegreen:0x98fb98ff,paleturquoise:0xafeeeeff,palevioletred:0xdb7093ff,papayawhip:0xffefd5ff,peachpuff:0xffdab9ff,peru:0xcd853fff,pink:0xffc0cbff,plum:0xdda0ddff,powderblue:0xb0e0e6ff,purple:0x800080ff,rebeccapurple:0x663399ff,red:0xff0000ff,rosybrown:0xbc8f8fff,royalblue:0x4169e1ff,saddlebrown:0x8b4513ff,salmon:0xfa8072ff,sandybrown:0xf4a460ff,seagreen:0x2e8b57ff,seashell:0xfff5eeff,sienna:0xa0522dff,silver:0xc0c0c0ff,skyblue:0x87ceebff,slateblue:0x6a5acdff,slategray:0x708090ff,slategrey:0x708090ff,snow:0xfffafaff,springgreen:0xff7fff,steelblue:0x4682b4ff,tan:0xd2b48cff,teal:8421631,thistle:0xd8bfd8ff,tomato:0xff6347ff,turquoise:0x40e0d0ff,violet:0xee82eeff,wheat:0xf5deb3ff,white:0xffffffff,whitesmoke:0xf5f5f5ff,yellow:0xffff00ff,yellowgreen:0x9acd32ff}});var cv=((a,{applyAnimatedValues:b=()=>!1,createAnimatedStyle:c=a=>new bb(a),getComponentProps:d=a=>a}={})=>{let e={applyAnimatedValues:b,createAnimatedStyle:c,getComponentProps:d},f=a=>{let b=bi(a)||"Anonymous";return(a=P.str(a)?f[a]||(f[a]=bf(a,e)):a[bh]||(a[bh]=bf(a,e))).displayName=`Animated(${b})`,a};return S(a,(b,c)=>{P.arr(a)&&(c=bi(b)),f[c]=f(b)}),{animated:f}})(["a","abbr","address","area","article","aside","audio","b","base","bdi","bdo","big","blockquote","body","br","button","canvas","caption","cite","code","col","colgroup","data","datalist","dd","del","details","dfn","dialog","div","dl","dt","em","embed","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","iframe","img","input","ins","kbd","keygen","label","legend","li","link","main","map","mark","menu","menuitem","meta","meter","nav","noscript","object","ol","optgroup","option","output","p","param","picture","pre","progress","q","rp","rt","ruby","s","samp","script","section","select","small","source","span","strong","style","sub","summary","sup","table","tbody","td","textarea","tfoot","th","thead","time","title","tr","track","u","ul","var","video","wbr","circle","clipPath","defs","ellipse","foreignObject","g","image","line","linearGradient","mask","path","pattern","polygon","polyline","radialGradient","rect","stop","svg","text","tspan"],{applyAnimatedValues:function(a,b){if(!a.nodeType||!a.setAttribute)return!1;let c="filter"===a.nodeName||a.parentNode&&"filter"===a.parentNode.nodeName,{className:d,style:e,children:f,scrollTop:g,scrollLeft:h,viewBox:i,...j}=b,k=Object.values(j),l=Object.keys(j).map(b=>c||a.hasAttribute(b)?b:cl[b]||(cl[b]=b.replace(/([A-Z])/g,a=>"-"+a.toLowerCase())));for(let b in void 0!==f&&(a.textContent=f),e)if(e.hasOwnProperty(b)){var m;let c=null==(m=e[b])||"boolean"==typeof m||""===m?"":"number"!=typeof m||0===m||ck.test(b)||cm.hasOwnProperty(b)&&cm[b]?(""+m).trim():m+"px";ck.test(b)?a.style.setProperty(b,c):a.style[b]=c}l.forEach((b,c)=>{a.setAttribute(b,k[c])}),void 0!==d&&(a.className=d),void 0!==g&&(a.scrollTop=g),void 0!==h&&(a.scrollLeft=h),void 0!==i&&a.setAttribute("viewBox",i)},createAnimatedStyle:a=>new ct(a),getComponentProps:({scrollTop:a,scrollLeft:b,...c})=>c}).animated;let cw={KOOL:{color:"#00ffff",shadow:"0 0 20px #00ffff"},COOL:{color:"#0099ff",shadow:"0 0 15px #0099ff"},GOOD:{color:"#00ff00",shadow:"0 0 10px #00ff00"},MISS:{color:"#ff0000",shadow:"0 0 10px #ff0000"}},cx=({judgment:a})=>{let b=cd(a?[a]:[],{from:{opacity:0,transform:"scale(0.5) translateY(50px)"},enter:{opacity:1,transform:"scale(1) translateY(0px)"},leave:{opacity:0,transform:"scale(0.5) translateY(-50px)"},config:{tension:280,friction:20},keys:a=>`${a}-${Date.now()}`});return(0,g.jsx)("div",{className:"absolute top-1/4 left-1/2 -translate-x-1/2 -translate-y-1/2 z-30 pointer-events-none",children:b((a,b)=>(0,g.jsx)(cv.div,{style:a,className:"text-7xl font-black uppercase tracking-widest",children:(0,g.jsx)("span",{style:{color:cw[b].color,textShadow:cw[b].shadow},children:b})}))})};class cy{static instance;audioContext=null;currentSource=null;currentBuffer=null;startTime=0;pauseTime=0;isPlaying=!1;isPaused=!1;volume=1;gainNode=null;hitsoundSources=new Map;hitsoundBuffers=new Map;hitsoundGainNode=null;endedListeners=new Set;constructor(){}static getInstance(){return cy.instance||(cy.instance=new cy),cy.instance}_toArrayBuffer(a){if(a instanceof ArrayBuffer)return a;if(a instanceof Uint8Array)return a.byteLength===a.buffer.byteLength?a.buffer:a.buffer.slice(a.byteOffset,a.byteOffset+a.byteLength);if(a&&"Buffer"===a.type&&Array.isArray(a.data))return new Uint8Array(a.data).buffer;throw Error(`Received invalid data type for audio asset: ${typeof a}`)}setupGainNodes(){this.audioContext&&(this.gainNode=this.audioContext.createGain(),this.gainNode.connect(this.audioContext.destination),this.hitsoundGainNode=this.audioContext.createGain(),this.hitsoundGainNode.connect(this.audioContext.destination))}async loadAudio(a){if(!this.audioContext)throw Error("AudioContext not initialized");try{let b=await window.electron.loadAsset(a),c=this._toArrayBuffer(b);this.currentBuffer=await this.audioContext.decodeAudioData(c)}catch(a){throw console.error("Failed to load audio:",a),a}}async loadHitsound(a,b){if(!this.audioContext)throw Error("AudioContext not initialized");try{let c=await window.electron.loadAsset(b),d=this._toArrayBuffer(c),e=await this.audioContext.decodeAudioData(d);this.hitsoundBuffers.set(a,e)}catch(b){throw console.error(`Failed to load hitsound ${a}:`,b),b}}play(a=0){if(!this.audioContext||!this.currentBuffer||!this.gainNode)return void console.warn("Cannot play: AudioContext, buffer, or gain node not available");this.stop(),this.currentSource=this.audioContext.createBufferSource(),this.currentSource.buffer=this.currentBuffer,this.currentSource.connect(this.gainNode),this.startTime=this.audioContext.currentTime,this.pauseTime=0,this.isPlaying=!0,this.isPaused=!1,this.currentSource.onended=()=>{this.isPlaying=!1,this.isPaused=!1,this.endedListeners.forEach(a=>a())},this.currentSource.start(0,a)}pause(){this.currentSource&&this.isPlaying&&!this.isPaused&&(this.currentSource.stop(),this.pauseTime=this.getCurrentTime(),this.isPlaying=!1,this.isPaused=!0)}resume(){this.isPaused&&this.pauseTime>0&&this.play(this.pauseTime)}stop(){this.currentSource&&(this.currentSource.stop(),this.currentSource=null),this.isPlaying=!1,this.isPaused=!1,this.startTime=0,this.pauseTime=0}playHitsound(a,b=1){if(!this.audioContext||!this.hitsoundGainNode)return;let c=this.hitsoundBuffers.get(a);if(!c)return void console.warn(`Hitsound not found: ${a}`);let d=this.audioContext.createBufferSource(),e=this.audioContext.createGain();d.buffer=c,e.gain.value=b,d.connect(e),e.connect(this.hitsoundGainNode),d.start(),d.onended=()=>{d.disconnect(),e.disconnect()}}getCurrentTime(){return this.audioContext?this.isPaused?this.pauseTime:this.isPlaying&&this.startTime>0?this.audioContext.currentTime-this.startTime:0:0}getDuration(){return this.currentBuffer?this.currentBuffer.duration:0}setVolume(a){this.volume=Math.max(0,Math.min(1,a)),this.gainNode&&(this.gainNode.gain.value=this.volume)}setHitsoundVolume(a){this.hitsoundGainNode&&(this.hitsoundGainNode.gain.value=Math.max(0,Math.min(1,a)))}getIsPlaying(){return this.isPlaying}getIsPaused(){return this.isPaused}onEnded(a){return this.endedListeners.add(a),()=>this.endedListeners.delete(a)}seekTo(a){this.isPlaying?this.play(a):this.pauseTime=a}}let cz=cy.getInstance(),cA=({chart:a,onPinThrow:b,score:d,combo:e,judgment:f,noteSpeed:i})=>{let[j,k]=(0,h.useState)(!1),[l,m]=(0,h.useState)([]),n=(0,h.useRef)(0),o=(0,h.useRef)(null),p=(0,h.useMemo)(()=>Math.max(400,2e3-i),[i]),{knives:q,throwKnife:r,getKnivesPositions:s,resetKnives:t,stuckKnivesCount:u,setHitCallback:v}=(({targetRadius:a,velocity:b=400,rotationSpeed:d=540,isGameActive:e})=>{let[f,g]=(0,h.useState)([]),i=(0,h.useRef)(null),j=(0,h.useRef)(0),k=(0,h.useRef)(null);(0,h.useEffect)(()=>{console.log("[useKnifePhysics] Initializing physics worker...");try{let e=new Worker(new URL(c.p+c.u(783),c.b));return i.current=e,console.log("[useKnifePhysics] Worker created, sending INIT message"),e.postMessage({type:"INIT",payload:{targetRadius:a,velocity:b,rotationSpeed:d}}),e.onmessage=a=>{let{type:b,payload:c}=a.data;console.log("[useKnifePhysics] Worker message:",b,c),"UPDATE"===b?g(c.knives):"HIT"===b&&(console.log("[useKnifePhysics] Hit detected at time:",c.hitTime),k.current&&k.current(c.hitTime))},e.onerror=a=>{console.error("[useKnifePhysics] Worker error:",a)},()=>{console.log("[useKnifePhysics] Terminating worker"),e.terminate()}}catch(a){console.error("[useKnifePhysics] Failed to create worker:",a)}},[a,b,d]);let l=(0,h.useCallback)(()=>{if(console.log("[useKnifePhysics] throwKnife called, isGameActive:",e,"worker:",!!i.current),!e||!i.current)return void console.log("[useKnifePhysics] Cannot throw knife - game inactive or no worker");let a={id:j.current++,isStuck:!1,stuckAngle:0,thrownAt:Date.now(),position:{x:0,y:250,rotation:0}};console.log("[useKnifePhysics] Throwing knife:",a),i.current.postMessage({type:"THROW",payload:{knife:a}})},[e]),m=(0,h.useCallback)(()=>f.map(a=>({knife:a,position:a.position})),[f]),n=(0,h.useCallback)(a=>{k.current=a},[]),o=(0,h.useCallback)(()=>{i.current&&i.current.postMessage({type:"RESET"}),g([]),j.current=0},[]),p=f.filter(a=>a.isStuck).length;return{knives:f,throwKnife:l,getKnivesPositions:m,resetKnives:o,stuckKnivesCount:p,setHitCallback:n}})({targetRadius:128,velocity:400,rotationSpeed:540,isGameActive:!0});(0,h.useEffect)(()=>{console.log("[PinGameView] Chart:",a?.title),console.log("[PinGameView] Knives count:",q.length),console.log("[PinGameView] Approach circles count:",l.length),console.log("[PinGameView] Current time:",n.current),console.log("[PinGameView] Stuck knives count:",u),console.log("[PinGameView] Notes in chart:",a?.notes?.length||0),console.log("[PinGameView] Audio service time:",cz.getCurrentTime())},[a,q.length,l.length,u]),(0,h.useEffect)(()=>{if(!a?.notes)return;let b=n.current,c=a.notes.filter(a=>{let c=1e3*a.time-p,d=1e3*a.time+1e3;return b>=c&&b<=d});console.log("[PinGameView] Current time:",b,"Upcoming notes:",c.length),c.length>0&&console.log("[PinGameView] First upcoming note:",c[0])},[a,n.current]),(0,h.useEffect)(()=>{let a,b=()=>{n.current=1e3*cz.getCurrentTime(),a=requestAnimationFrame(b)};return a=requestAnimationFrame(b),()=>cancelAnimationFrame(a)},[]),(0,h.useEffect)(()=>{let a=setInterval(()=>{let a=1e3*cz.getCurrentTime();m(b=>{let c=b.map(b=>({...b,scale:Math.max(.1,1-(a-b.startTime)/p)})).filter(b=>a-b.startTime<p);return c.length!==b.length||c.some((a,c)=>b[c]&&Math.abs(a.scale-b[c].scale)>.01)?c:b})},150);return()=>clearInterval(a)},[p]),(0,h.useEffect)(()=>{if(!a?.notes)return;let b=n.current,c=a.notes.filter(a=>{let c=1e3*a.time;return c>b&&c<=b+p}).map(a=>({id:`circle-${a.time}`,noteTime:1e3*a.time,startTime:b,uniqueKey:`${a.time}-${b}`,scale:1}));m(a=>{let b=new Set(a.map(a=>a.id));return[...a,...c.filter(a=>!b.has(a.id))]})},[a?.notes]),(0,h.useEffect)(()=>{v(a=>{b()})},[v,b]);let w=(0,h.useCallback)(()=>{j||(k(!0),r(),setTimeout(()=>k(!1),150))},[j,r]),x=(0,h.useCallback)(a=>{"KeyS"!==a.code||j||w()},[j,w]);return(0,h.useEffect)(()=>(window.addEventListener("keydown",x),()=>window.removeEventListener("keydown",x)),[x]),(0,g.jsxs)("div",{className:"min-h-screen relative overflow-hidden flex flex-col items-center justify-center",children:[(0,g.jsxs)("div",{className:"absolute top-8 left-8 text-white z-20 bg-black/30 p-4 rounded-xl backdrop-blur-sm border border-white/10 shadow-lg",children:[(0,g.jsxs)("div",{className:"text-3xl font-bold tracking-tighter",children:["Score: ",d]}),(0,g.jsxs)("div",{className:"text-xl mt-1",children:["Combo: ",e]})]}),(0,g.jsxs)("div",{className:"relative w-96 h-96 flex items-center justify-center",children:[(0,g.jsx)("div",{className:"absolute inset-0 flex items-center justify-center",children:(0,g.jsx)("div",{className:"w-64 h-64 bg-red-500/20 rounded-full border-4 border-red-500 shadow-lg",style:{boxShadow:"0 0 30px rgba(239, 68, 68, 0.5)"}})}),l.map(a=>{let b=Math.min(1,(n.current-a.startTime)/p),c=400-144*b,d=Math.max(.4,1-.6*b);return(0,g.jsx)("div",{className:"absolute inset-0 flex items-center justify-center pointer-events-none",children:(0,g.jsx)("div",{className:"rounded-full border-4 border-blue-400",style:{width:`${c}px`,height:`${c}px`,opacity:d,boxShadow:`0 0 20px rgba(96, 165, 250, ${.8*d})`,transition:"none",aspectRatio:"1",flexShrink:0}})},a.uniqueKey)}),(0,g.jsx)("div",{ref:o,className:"absolute inset-0 flex items-center justify-center z-10 animate-spin",style:{animationDuration:"3s",animationTimingFunction:"linear"},children:(0,g.jsx)("div",{className:"w-8 h-8 bg-gray-600 rounded-full border-2 border-gray-400 shadow-lg"})}),s().map(({knife:a,position:b})=>(0,g.jsx)("div",{className:"absolute left-1/2 top-1/2 z-20",style:{transform:`translate(-50%, -50%) translate(${b.x}px, ${b.y}px) rotate(${b.rotation}deg)`},children:(0,g.jsxs)("svg",{width:"18",height:"64",viewBox:"0 0 18 64",fill:"none",children:[(0,g.jsx)("path",{d:"M9 2 L16 34 L2 34 Z",fill:"#d1d5db",stroke:"#e5e7eb",strokeWidth:"1"}),(0,g.jsx)("rect",{x:"3",y:"34",width:"12",height:"4",rx:"2",fill:"#9ca3af"}),(0,g.jsx)("rect",{x:"5.5",y:"38",width:"7",height:"18",rx:"2",fill:"#92400e"}),(0,g.jsx)("circle",{cx:"9",cy:"58",r:"4",fill:"#78350f"})]})},a.id)),e>2&&(0,g.jsx)("div",{className:"absolute -bottom-20 text-5xl font-black text-yellow-300 animate-pulse z-30",children:(0,g.jsxs)("span",{style:{textShadow:"0 0 15px rgba(253, 224, 71, 0.8)"},children:[e," COMBO!"]})}),(0,g.jsx)(cx,{judgment:f})]})]})};function cB(a,b,c){return Math.max(b,Math.min(c,a))}let cC=({radius:a,scale:b,opacity:c})=>{let d=2*a*b;return(0,g.jsx)("div",{className:"absolute rounded-full border-4 border-white/80 pointer-events-none",style:{width:`${d}px`,height:`${d}px`,opacity:c,boxShadow:"0 0 16px rgba(255,255,255,0.35)"}})},cD=({hitErrors:a,maxErrorMs:b})=>{let c=a.length>0?a.reduce((a,b)=>a+b,0)/a.length:0,d=`${50+c/b*50}%`;return(0,g.jsxs)("div",{className:"absolute bottom-12 left-1/2 -translate-x-1/2 w-72 h-4 bg-transparent flex items-center justify-center pointer-events-none",children:[(0,g.jsx)("div",{className:"w-full h-1 bg-black/30 rounded-full overflow-hidden",children:(0,g.jsxs)("div",{className:"absolute w-full h-full flex justify-between items-center",children:[(0,g.jsx)("div",{className:"w-[3px] h-[3px] bg-cyan-400 rounded-full"}),(0,g.jsx)("div",{className:"w-[3px] h-[3px] bg-green-400 rounded-full"}),(0,g.jsx)("div",{className:"w-[3px] h-[3px] bg-yellow-400 rounded-full"})]})}),(0,g.jsx)("div",{className:"absolute w-full h-full",children:a.map((c,d)=>{let e=`${50+c/b*50}%`;return(0,g.jsx)("div",{className:"absolute top-1/2 -translate-y-1/2 w-1 h-3 bg-white/80 rounded-full shadow-lg transition-all duration-300 ease-out",style:{left:e,opacity:1-(a.length-1-d)*.1}},d)})}),(0,g.jsx)("div",{className:"absolute top-0 bottom-0 left-1/2 -translate-x-1/2 w-0.5 bg-cyan-300 shadow-lg"}),(0,g.jsx)("div",{className:"absolute top-0 bottom-0 w-0.5 bg-yellow-300 transition-all duration-200 ease-in-out",style:{left:d}})]})},cE={KOOL:"#00ffff",COOL:"#88ff88",GOOD:"#ffcc22",MISS:"#ff6666"},cF=({judgment:a,hitError:b,onAnimationEnd:c})=>{let[d,e]=cc(()=>({from:{opacity:0,transform:"scale(0.8) translateY(20px)"},to:{opacity:1,transform:"scale(1) translateY(0px)"},config:{tension:300,friction:15},onRest:()=>{setTimeout(()=>{e.start({to:{opacity:0,transform:"scale(1) translateY(-30px)"},config:{tension:300,friction:20},onRest:c})},400)}})),f="KOOL"===a&&Math.abs(b)>2?b<0?"#88ccff":"#ff8888":cE[a];return(0,g.jsx)(cv.div,{style:d,className:"absolute text-2xl font-bold uppercase pointer-events-none -translate-x-1/2 -translate-y-1/2",children:(0,g.jsx)("span",{style:{color:f,textShadow:`0 0 8px ${f}`},children:a})})},cG=({onAnimationEnd:a,color:b})=>{let[c]=function(a,b,c){let d,e=P.fun(b)&&b;e&&!c&&(c=[]);let f=!0,g=cb(a,(a,c)=>{let g=e?e(a,c):b;return d=g.ref,f=f&&g.reverse,g},c||[{}]);if(a$(()=>{R(g[1].current,(a,b)=>{let c=g[1].current[b+(f?1:-1)];if(bw(a,d),a.ref){c&&a.update({to:c.springs});return}c?a.start({to:c.springs}):a.start()})},c),e||3==arguments.length){let a=d??g[1];return a._getProps=(b,c,d)=>{let e=P.fun(b)?b(d,c):b;if(e){let b=a.current[d+(e.reverse?1:-1)];return b&&(e.to=b.springs),e}},g}return g[0]}(8,b=>({from:{opacity:1,scale:0,x:0,y:0},to:{opacity:0,scale:1.5,x:(Math.random()-.5)*150,y:(Math.random()-.5)*150},config:{mass:1,tension:400,friction:30},onRest:()=>{7===b&&a()}}));return(0,g.jsx)("div",{className:"absolute w-1 h-1",children:c.map((a,c)=>(0,g.jsx)(cv.div,{className:"absolute rounded-full",style:{...a,width:"8px",height:"8px",backgroundColor:b,boxShadow:`0 0 10px ${b}`}},c))})},cH={KOOL:"#00ffff",COOL:"#88ff88",GOOD:"#ffcc22",MISS:"#ff6666"},cI=({chart:a})=>{var b;let{score:c,combo:d,judgment:e,isPaused:f,updateGame:i,togglePause:j,reset:k}=r(),[l,m]=(0,h.useState)([]),[n,o]=(0,h.useState)([]),[p,q]=(0,h.useState)([]),[s,t]=(0,h.useState)([]),u=(0,h.useRef)(0),v=(b=a.metadata?.approachRate??5)<=5?1800-120*b:1200-150*(b-5),{w300:w}=function(a){return{w300:80-6*a,w100:140-8*a,w50:200-10*a}}(a.metadata?.overallDifficulty??5);(0,h.useEffect)(()=>{let b=window.electron.onGameUpdate(b=>{if(b.judgment&&void 0!==b.hitError){let c=x(a.notes.findIndex(a=>a.time===1e3*b.noteTime)%8/8*360,150),d=`${Date.now()}`,e=cH[b.judgment]||"#ffffff";if(o(a=>[...a,{id:d,judgment:b.judgment,hitError:b.hitError,x:c.x,y:c.y}]),"MISS"!==b.judgment){q(a=>[...a,{id:d,x:c.x,y:c.y,color:e}]);try{cz.playHitsound("normal-hitnormal")}catch(a){}}}void 0!==b.hitError&&m(a=>[...a.slice(-19),b.hitError]),i(b)});return()=>{b()}},[i,a.notes]);let x=(a,b)=>{let c=Math.PI/180*(a-90);return{x:Math.cos(c)*b,y:Math.sin(c)*b}};(0,h.useEffect)(()=>{let b,c=()=>{let d=1e3*cz.getCurrentTime();u.current=d,t(a.notes.filter(a=>{let b=1e3*a.time;return d>=b-v&&d<=b+250})),b=requestAnimationFrame(c)};return b=requestAnimationFrame(c),()=>cancelAnimationFrame(b)},[a.notes,v]);let y=(0,h.useCallback)(()=>{f||window.electron.handlePinPress(cz.getCurrentTime())},[f]);return(0,g.jsxs)("div",{className:"absolute inset-0 cursor-pointer",onClick:y,children:[p.map(a=>(0,g.jsx)("div",{style:{position:"absolute",left:"50%",top:"50%",transform:`translate(calc(-50% + ${a.x}px), calc(-50% + ${a.y}px))`},children:(0,g.jsx)(cG,{color:a.color,onAnimationEnd:()=>q(b=>b.filter(b=>b.id!==a.id))})},a.id)),n.map(a=>(0,g.jsx)("div",{style:{position:"absolute",left:"50%",top:"50%",transform:`translate(calc(-50% + ${a.x}px), calc(-50% + ${a.y}px))`},children:(0,g.jsx)(cF,{judgment:a.judgment,hitError:a.hitError,onAnimationEnd:()=>o(b=>b.filter(b=>b.id!==a.id)),id:a.id})},a.id)),(0,g.jsx)(cD,{hitErrors:l,maxErrorMs:w}),s.map(a=>{let b=1e3*a.time,c=b-v,d=u.current,e=function(a,b,c,d=2){return d+(1-d)*cB(1-(b-a)/c,0,1)}(d,b,v,2),f=function(a,b,c){let d=cB((a-b)/(.4*c),0,1);return d*d*(3-2*d)}(d,c,v);return(0,g.jsxs)("div",{className:"absolute left-1/2 top-1/2",style:{transform:"translate(-50%, -50%)"},children:[(0,g.jsx)("div",{className:"absolute rounded-full bg-blue-500/50 border-2 border-white shadow",style:{width:"96px",height:"96px",opacity:f,boxShadow:"0 0 24px rgba(59,130,246,0.45)"}}),(0,g.jsx)(cC,{radius:48,scale:e,opacity:f})]},a.time)})]})},cJ=({chart:a,isLoading:b,onStartGame:c,onBackToMenu:d})=>(0,g.jsx)("div",{className:"flex flex-col items-center justify-center min-h-screen bg-gradient-to-br from-purple-900 via-blue-900 to-indigo-900 text-white",children:(0,g.jsxs)("div",{className:"text-center space-y-8 p-8 bg-black/30 rounded-xl backdrop-blur-sm border border-white/10",children:[(0,g.jsx)("h1",{className:"text-4xl font-bold bg-gradient-to-r from-cyan-400 to-purple-400 bg-clip-text text-transparent",children:"Ready to Play?"}),b?(0,g.jsxs)("div",{className:"space-y-4",children:[(0,g.jsx)("div",{className:"animate-spin w-12 h-12 border-4 border-cyan-400 border-t-transparent rounded-full mx-auto"}),(0,g.jsx)("p",{className:"text-lg text-gray-300",children:"Loading chart and audio..."})]}):(0,g.jsxs)("div",{className:"space-y-6",children:[(0,g.jsx)("p",{className:"text-lg text-gray-300",children:"Chart loaded and ready!"}),(0,g.jsxs)("div",{className:"flex gap-4 justify-center",children:[(0,g.jsx)("button",{onClick:c,className:"px-8 py-3 bg-gradient-to-r from-green-500 to-emerald-600 hover:from-green-600 hover:to-emerald-700 rounded-lg font-semibold text-white transition-all duration-200 transform hover:scale-105 shadow-lg",children:"Start Game"}),(0,g.jsx)("button",{onClick:d,className:"px-6 py-3 bg-gray-600 hover:bg-gray-500 rounded-lg transition-colors",children:"Back to Menu"})]})]})]})}),cK=({onResume:a,onRestart:b,onBackToMenu:c})=>(0,g.jsx)("div",{className:"fixed inset-0 bg-black/80 backdrop-blur-sm flex items-center justify-center z-50",children:(0,g.jsxs)("div",{className:"bg-gradient-to-br from-gray-900 to-gray-800 p-8 rounded-xl border border-white/20 shadow-2xl",children:[(0,g.jsx)("h2",{className:"text-3xl font-bold text-center mb-8 bg-gradient-to-r from-cyan-400 to-purple-400 bg-clip-text text-transparent",children:"일시정지"}),(0,g.jsxs)("div",{className:"space-y-4 min-w-[200px]",children:[(0,g.jsx)("button",{onClick:a,className:"w-full px-6 py-3 bg-gradient-to-r from-green-500 to-emerald-600 hover:from-green-600 hover:to-emerald-700 rounded-lg font-semibold text-white transition-all duration-200 transform hover:scale-105 shadow-lg",children:"계속하기"}),(0,g.jsx)("button",{onClick:b,className:"w-full px-6 py-3 bg-gradient-to-r from-blue-500 to-blue-600 hover:from-blue-600 hover:to-blue-700 rounded-lg font-semibold text-white transition-all duration-200 transform hover:scale-105 shadow-lg",children:"다시시작"}),(0,g.jsx)("button",{onClick:c,className:"w-full px-6 py-3 bg-gray-600 hover:bg-gray-500 rounded-lg font-semibold text-white transition-colors",children:"메뉴로"})]}),(0,g.jsx)("p",{className:"text-center text-gray-400 text-sm mt-6",children:"ESC 키를 눌러 계속하기"})]})}),cL=({videoPath:a,className:b=""})=>{let[c,d]=(0,h.useState)(null),[e,f]=(0,h.useState)(!1),[i,j]=(0,h.useState)(!1),[k,l]=(0,h.useState)(!1),m=(0,h.useRef)(null);return((0,h.useEffect)(()=>(c&&c.startsWith("blob:")&&URL.revokeObjectURL(c),a)?(f(!0),j(!1),l(!1),window.electron.loadAsset(a).then(a=>{if(a){let b=new Blob([a],{type:"video/mp4"});d(URL.createObjectURL(b)),f(!1)}else throw Error("IPC returned no data for video asset")}).catch(a=>{console.error("Failed to load video asset via IPC:",a),j(!0),f(!1)}),()=>{c&&c.startsWith("blob:")&&URL.revokeObjectURL(c)}):void d(null),[a]),c)?(0,g.jsx)("video",{ref:m,className:`fixed inset-0 w-full h-full object-cover z-0 ${b}`,src:c,autoPlay:!0,loop:!0,muted:!0,playsInline:!0,onLoadStart:()=>{f(!0)},onCanPlay:()=>{f(!1),l(!0),j(!1)},onError:()=>{console.error(`Failed to load video: ${c}`),f(!1),j(!0)},style:{opacity:+!!k,transition:"opacity 0.5s ease-in-out"}}):(0,g.jsxs)("div",{className:"fixed inset-0 z-0 bg-black flex items-center justify-center",children:[e&&(0,g.jsx)("div",{className:"text-white",children:"Loading Video..."}),i&&(0,g.jsx)("div",{className:"text-red-500",children:"Error Loading Video"})]})},cM=({selectedChart:a,onBack:b})=>{let{score:c,combo:d,judgment:e,isPaused:f,updateGame:i,togglePause:j,reset:k}=r(),[l,m]=(0,h.useState)(null),[n,o]=(0,h.useState)(!1),[p,q]=(0,h.useState)(!0),[s,t]=(0,h.useState)(null),[u,v]=(0,h.useState)(null),w=async()=>{if(!l||p)return void console.warn("Pin chart or audio not loaded yet. Cannot start game.");console.log("Starting pin game..."),o(!0);try{let a=await window.electron.startGame(l);if(!a.success){console.error("Failed to start game in main process:",a.error),alert(`Failed to start game: ${a.error}`),o(!1);return}cz.play()}catch(a){console.error("Error during game start:",a),alert(`Failed to start game: ${a instanceof Error?a.message:"Unknown error"}`),o(!1)}},x=()=>{if(!n||f)return;let a=cz.getCurrentTime();window.electron.handlePinPress(a)};return((0,h.useEffect)(()=>{(async()=>{if(!a){console.error("No chart selected, returning to select screen."),b();return}try{if(q(!0),console.log("[Renderer] Loading PinChart:",a),!a||!a.notes||0===a.notes.length){console.error("[Renderer] CRITICAL: Chart data is missing or notes are empty!"),alert("Chart data is invalid. Returning to selection."),b();return}if(console.log("[Renderer] Chart validation passed - notes count:",a.notes.length),m(a),a.audioFilename){let b=a.audioFilename;!b.includes("://")&&a.folderPath&&(b=`${a.folderPath}/${b}`),console.log(`[GameScene] Loading main audio: ${b}`),await cz.loadAudio(b)}let c=async(b,c)=>{if(a.folderPath)try{let d=`${a.folderPath}/${c}`;await window.electron.assetExists(d)&&(await cz.loadHitsound(b,d),console.log(`[AssetLoad] Successfully loaded sound: ${d} as '${b}'`))}catch(a){console.warn(`Could not load optional sound asset: ${c}`,a)}};if(await c("normal-hitnormal","normal-hitnormal.wav"),await c("combobreak","combobreak.wav"),await c("normal-hitwhistle","normal-hitwhistle.wav"),a.videoPath)t(a.videoPath),v(null);else if(a.backgroundPath){t(null);try{let b=await window.electron.loadAsset(a.backgroundPath),c=new Blob([b],{type:"image/jpeg"}),d=URL.createObjectURL(c);v(d)}catch(a){console.error("Failed to load background image:",a),v(null)}}else t(null),v(null);q(!1)}catch(a){console.error("CRITICAL: Failed to load game assets. Aborting game.",a);try{window.electron.stopGame()}catch(a){console.error("Failed to stop game in main process:",a)}alert(`Failed to load game assets: ${a instanceof Error?a.message:"Unknown error"}

Returning to song selection.`),b()}})()},[a?.id]),(0,h.useEffect)(()=>{let a=window.electron.onGameUpdate(a=>{i(a)});return()=>{a(),cz.stop()}},[]),(0,h.useEffect)(()=>{let a=a=>{n&&!f&&"Space"===a.code&&(a.preventDefault(),x())};return n&&!f&&window.addEventListener("keydown",a),()=>{window.removeEventListener("keydown",a)}},[n,f]),(0,h.useEffect)(()=>{let a=a=>{"Escape"===a.code&&(a.preventDefault(),j())};return n&&window.addEventListener("keydown",a),()=>{window.removeEventListener("keydown",a)}},[n,j]),n)?f?(0,g.jsx)(cK,{onResume:j,onRestart:()=>{k(),j(),w()},onBackToMenu:()=>{k(),j(),b()}}):(0,g.jsxs)("div",{className:"relative w-full h-screen overflow-hidden bg-black",children:[s?(0,g.jsx)(cL,{videoPath:s},s):u?(0,g.jsx)("div",{className:"absolute inset-0 z-0 bg-cover bg-center",style:{backgroundImage:`url(${u})`}}):(0,g.jsx)("div",{className:"absolute inset-0 z-0 bg-gray-900"}),l&&("osu"===l.gameMode?(0,g.jsx)(cI,{chart:l}):(0,g.jsx)(cA,{chart:l,onPinThrow:x,score:c,combo:d,judgment:e,noteSpeed:500})),(0,g.jsxs)("div",{className:"absolute top-4 right-4 bg-black/50 text-white p-2 text-sm z-50",children:[(0,g.jsxs)("div",{children:["Chart: ",l?.title||"None"]}),(0,g.jsxs)("div",{children:["Notes: ",l?.notes?.length||0]}),(0,g.jsxs)("div",{children:["Game Started: ",n?"Yes":"No"]}),(0,g.jsxs)("div",{children:["Loading: ",p?"Yes":"No"]}),(0,g.jsxs)("div",{children:["Audio Time: ",cz.getCurrentTime().toFixed(2),"s"]})]})]}):(0,g.jsx)(cJ,{chart:l,isLoading:p,onStartGame:w,onBackToMenu:b})},cN=({score:a,maxCombo:b})=>{let{rank:c,color:d}=(a=>a>95e4?{rank:"S",color:"text-theme-highlight"}:a>9e5?{rank:"A",color:"text-theme-primary"}:a>8e5?{rank:"B",color:"text-theme-primary/80"}:a>7e5?{rank:"C",color:"text-theme-text-dark"}:{rank:"D",color:"text-theme-accent"})(a);return(0,g.jsxs)("div",{className:"text-center",children:[(0,g.jsx)("p",{className:"text-2xl text-theme-text-dark font-medium mb-2",children:"FINAL SCORE"}),(0,g.jsx)("p",{className:"text-8xl font-black text-transparent bg-gradient-to-r from-theme-primary to-theme-secondary bg-clip-text mb-4",children:a.toLocaleString()}),(0,g.jsxs)("div",{className:"flex justify-center items-baseline gap-8 text-theme-text-light",children:[(0,g.jsxs)("div",{className:"text-center",children:[(0,g.jsx)("p",{className:"text-lg text-theme-text-dark",children:"RANK"}),(0,g.jsx)("p",{className:`text-5xl font-bold ${d}`,children:c})]}),(0,g.jsxs)("div",{className:"text-center",children:[(0,g.jsx)("p",{className:"text-lg text-theme-text-dark",children:"MAX COMBO"}),(0,g.jsx)("p",{className:"text-5xl font-bold",children:b})]})]})]})},cO={KOOL:"text-theme-highlight",COOL:"text-theme-primary",GOOD:"text-green-400",MISS:"text-theme-accent"},cP=({judgments:a})=>(0,g.jsx)("div",{className:"grid grid-cols-4 gap-4 text-center",children:["KOOL","COOL","GOOD","MISS"].map(b=>(0,g.jsxs)("div",{children:[(0,g.jsx)("p",{className:`text-lg ${cO[b]} font-bold`,children:b}),(0,g.jsx)("p",{className:"text-3xl font-semibold text-theme-text-light",children:a[b]})]},b))}),cQ=({label:a,onClick:b,variant:c})=>(0,g.jsx)("button",{onClick:b,className:`px-8 py-3 rounded-xl transition-all duration-200 font-medium transform hover:scale-105 ${{primary:"bg-theme-primary/20 hover:bg-theme-primary/30 border border-theme-primary/50 text-theme-primary hover:text-theme-primary/90",secondary:"bg-theme-text-dark/30 hover:bg-theme-text-dark/50 text-theme-text-light/80 hover:text-theme-text-light"}[c]}`,children:a}),cR=({onRestart:a,onSelectMusic:b})=>(0,g.jsx)("div",{className:"flex justify-center gap-6",children:[{label:"Retry",onClick:a,variant:"primary"},{label:"Back to Menu",onClick:b,variant:"secondary"}].map(a=>(0,g.jsx)(cQ,{...a},a.label))}),cS={S:"text-yellow-400",A:"text-green-400",B:"text-blue-400",C:"text-purple-400",D:"text-gray-500"},cT=({rank:a})=>{let b=cS[a]||"text-gray-500";return(0,g.jsxs)("div",{className:"flex flex-col items-center",children:[(0,g.jsx)("p",{className:"text-2xl font-semibold text-theme-text-light/80 mb-2",children:"Rank"}),(0,g.jsx)("div",{className:`text-9xl font-black ${b} transform-gpu transition-all duration-500`,style:{filter:`drop-shadow(0 0 20px ${b.replace("text-","bg-").split("-")[0]})`},children:a})]})},cU=({accuracy:a})=>{let b=2*Math.PI*60,{val:c}=cc({from:{val:0},to:{val:a},config:{duration:1e3}}),{strokeDashoffset:d}=cc({from:{strokeDashoffset:b},to:{strokeDashoffset:b-a/100*b},config:{duration:1e3}});return(0,g.jsxs)("div",{className:"flex flex-col items-center",children:[(0,g.jsx)("p",{className:"text-2xl font-semibold text-theme-text-light/80 mb-4",children:"Accuracy"}),(0,g.jsxs)("div",{className:"relative w-40 h-40",children:[(0,g.jsxs)("svg",{className:"w-full h-full",viewBox:"0 0 140 140",children:[(0,g.jsx)("circle",{cx:"70",cy:"70",r:60,strokeWidth:"10",className:"stroke-current text-theme-text-dark/30",fill:"transparent"}),(0,g.jsx)(cv.circle,{cx:"70",cy:"70",r:60,strokeWidth:"10",className:"stroke-current text-theme-accent transform -rotate-90 origin-center",fill:"transparent",strokeDasharray:b,strokeDashoffset:d,strokeLinecap:"round"})]}),(0,g.jsx)("div",{className:"absolute inset-0 flex items-center justify-center",children:(0,g.jsx)(cv.p,{className:"text-4xl font-bold text-theme-text-light",children:c.to(a=>`${a.toFixed(2)}%`)})})]})]})},cV=({onBack:a})=>{let{score:b,maxCombo:c,judgments:d,reset:e,setCurrentScene:f}=r(),[i,j]=(0,h.useState)(0),[k,l]=(0,h.useState)("");(0,h.useEffect)(()=>{let a=(a=>{let b=a.KOOL+a.COOL+a.GOOD+a.MISS;return 0===b?0:parseFloat(((+a.KOOL+.5*a.COOL+.25*a.GOOD)/b*100).toFixed(2))})(d),b=(a=>a>=98?"S":a>=95?"A":a>=90?"B":a>=80?"C":"D")(a);j(a),l(b)},[d]);let m=()=>{e(),f("Game")},n=()=>{e(),f("Select")},o=cd([a=>(0,g.jsx)(cv.div,{style:a,children:(0,g.jsx)(cN,{score:b,maxCombo:c})}),a=>(0,g.jsx)(cv.div,{style:a,children:(0,g.jsx)("div",{className:"w-full h-px bg-theme-text-dark/50"})}),a=>(0,g.jsx)(cv.div,{style:a,children:(0,g.jsxs)("div",{className:"flex justify-around items-center",children:[(0,g.jsx)(cT,{rank:k}),(0,g.jsx)(cU,{accuracy:i})]})}),a=>(0,g.jsx)(cv.div,{style:a,children:(0,g.jsx)("div",{className:"w-full h-px bg-theme-text-dark/50"})}),a=>(0,g.jsx)(cv.div,{style:a,children:(0,g.jsx)(cP,{judgments:d})}),a=>(0,g.jsx)(cv.div,{style:a,children:(0,g.jsx)("div",{className:"w-full h-px bg-theme-text-dark/50"})}),a=>(0,g.jsx)(cv.div,{style:a,children:(0,g.jsx)(cR,{onRestart:m,onSelectMusic:n})})],{from:{opacity:0,transform:"translateY(20px)"},enter:{opacity:1,transform:"translateY(0px)"},trail:200});return(0,g.jsx)("div",{className:"min-h-screen bg-theme-bg flex items-center justify-center p-8",children:(0,g.jsxs)("div",{className:"bg-theme-bg/70 backdrop-blur-xl rounded-3xl p-12 border border-theme-text-dark/50 shadow-2xl max-w-3xl w-full space-y-8",children:[(0,g.jsx)("button",{onClick:a,className:"px-6 py-3 bg-theme-secondary text-white rounded-lg hover:bg-theme-secondary/80 transition-colors",children:"Back to Menu"}),(0,g.jsx)("h1",{className:"text-6xl font-black text-center bg-clip-text text-transparent bg-gradient-to-b from-theme-accent to-theme-secondary animate-pulse",children:"GAME CLEAR"}),o((a,b)=>b(a))]})})},cW=({label:a,value:b,min:c,max:d,step:e,onChange:f})=>(0,g.jsxs)("div",{className:"setting-item",children:[(0,g.jsxs)("label",{htmlFor:a,className:"text-2xl font-semibold mb-4 flex justify-between items-center",children:[(0,g.jsx)("span",{children:a}),(0,g.jsx)("span",{className:"text-3xl font-bold text-theme-secondary bg-theme-bg/50 px-4 py-1 rounded-lg",children:b})]}),(0,g.jsx)("input",{type:"range",id:a,min:c,max:d,step:e,value:b,onChange:f,className:"w-full h-3 bg-theme-text-light/10 rounded-full appearance-none cursor-pointer range-lg accent-theme-accent focus:outline-none focus:ring-2 focus:ring-theme-secondary focus:ring-opacity-50 transition-all duration-300"})]}),cX=({label:a,value:b})=>(0,g.jsxs)("div",{className:"opacity-50",children:[(0,g.jsxs)("label",{className:"text-2xl font-semibold mb-4 flex justify-between items-center",children:[(0,g.jsx)("span",{children:a}),(0,g.jsx)("span",{className:"text-3xl font-bold text-theme-secondary bg-theme-bg/50 px-4 py-1 rounded-lg",children:b})]}),(0,g.jsx)("input",{type:"range",disabled:!0,className:"w-full h-3 bg-theme-text-light/10 rounded-full appearance-none cursor-not-allowed"}),(0,g.jsx)("p",{className:"text-sm text-right mt-2",children:"Coming Soon"})]}),cY=[{id:"noteSpeed",label:"Note Speed",min:100,max:1e3,step:50,enabled:!0}],cZ=({onBack:a})=>{r(a=>a.setCurrentScene);let[b,c]=(0,h.useState)({});return(0,h.useEffect)(()=>{(async()=>{let a={};for(let b of cY)b.enabled&&(a[b.id]=await window.electron.getSetting(b.id));c(a)})()},[]),(0,g.jsxs)("div",{className:"min-h-screen bg-theme-bg text-theme-text-light flex flex-col items-center justify-center p-8",children:[(0,g.jsx)("div",{className:"absolute top-8 left-8",children:(0,g.jsx)("button",{onClick:a,className:"px-6 py-3 bg-theme-secondary text-white rounded-lg hover:bg-theme-secondary/80 transition-colors",children:"Back to Menu"})}),(0,g.jsxs)("div",{className:"w-full max-w-2xl bg-theme-bg/70 backdrop-blur-xl rounded-2xl shadow-2xl p-10 border border-theme-text-dark/50",children:[(0,g.jsx)("h1",{className:"text-5xl font-bold text-center mb-12 bg-clip-text text-transparent bg-gradient-to-r from-theme-secondary to-theme-accent animate-pulse",children:"Settings"}),(0,g.jsx)("div",{className:"space-y-10",children:cY.map(a=>a.enabled?(0,g.jsx)(cW,{label:a.label,value:b[a.id]??a.min??0,min:a.min??0,max:a.max??100,step:a.step??1,onChange:d=>((a,d)=>{c({...b,[a]:d}),window.electron.setSetting(a,d)})(a.id,parseInt(d.target.value,10))},a.id):(0,g.jsx)(cX,{label:a.label,value:100},a.id))})]}),(0,g.jsx)("p",{className:"mt-8 text-sm text-theme-text-dark",children:"More settings will be available in future updates."})]})},c$=({onBack:a,onChartSelected:b})=>{let[c,d]=(0,h.useState)([]),[e,f]=(0,h.useState)(!1),[i,j]=(0,h.useState)("");(0,h.useEffect)(()=>{k()},[]);let k=async()=>{try{let a=await window.electron.getChartLibrary();d(a)}catch(a){console.error("Failed to load chart library:",a)}},l=async()=>{try{f(!0),j("파일 선택 중...");let a=await window.electron.selectOszFile();if(!a){j(""),f(!1);return}j("차트 임포트 중..."),await window.electron.importOszFile(a),j("임포트 완료!"),setTimeout(()=>j(""),2e3),await k()}catch(a){console.error("Failed to import .osz file:",a),j("임포트 실패: "+a.message),setTimeout(()=>j(""),3e3)}finally{f(!1)}},m=async(a,c)=>{try{f(!0),j("차트 변환 중...");let d=await window.electron.convertDifficultyToPinChart(a,c);b(d)}catch(a){console.error("Failed to convert difficulty:",a),j("변환 실패: "+a.message),setTimeout(()=>j(""),3e3)}finally{f(!1)}},n=async a=>{if(confirm("이 차트를 삭제하시겠습니까?"))try{await window.electron.invoke("remove-chart-from-library",a),await k()}catch(a){console.error("Failed to remove chart:",a)}};return(0,g.jsxs)("div",{className:"min-h-screen bg-theme-bg-primary text-white p-8",children:[(0,g.jsxs)("div",{className:"flex items-center justify-between mb-8",children:[(0,g.jsxs)("div",{children:[(0,g.jsx)("h1",{className:"text-4xl font-bold text-theme-primary mb-2",children:".osz 차트 라이브러리"}),(0,g.jsx)("p",{className:"text-theme-text-secondary",children:"osu! 비트맵(.osz) 파일을 임포트하여 플레이하세요"})]}),(0,g.jsx)("button",{onClick:a,className:"px-6 py-3 bg-theme-secondary text-white rounded-lg hover:bg-theme-secondary/80 transition-colors",children:"뒤로가기"})]}),(0,g.jsxs)("div",{className:"mb-8",children:[(0,g.jsx)("button",{onClick:l,disabled:e,className:"px-8 py-4 bg-theme-primary text-white rounded-lg hover:bg-theme-primary/80 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:e?"처리 중...":".osz 파일 임포트"}),i&&(0,g.jsx)("p",{className:"mt-2 text-theme-accent",children:i})]}),(0,g.jsx)("div",{className:"grid gap-6",children:0===c.length?(0,g.jsxs)("div",{className:"text-center py-12",children:[(0,g.jsx)("p",{className:"text-theme-text-secondary text-lg",children:"임포트된 차트가 없습니다."}),(0,g.jsx)("p",{className:"text-theme-text-secondary mt-2",children:".osz 파일을 임포트하여 시작하세요."})]}):c.map(a=>(0,g.jsxs)("div",{className:"bg-theme-bg-secondary rounded-lg p-6 border border-theme-border",children:[(0,g.jsxs)("div",{className:"flex items-start justify-between mb-4",children:[(0,g.jsxs)("div",{children:[(0,g.jsx)("h3",{className:"text-xl font-bold text-theme-primary",children:a.title}),(0,g.jsxs)("p",{className:"text-theme-text-secondary",children:["by ",a.artist," • mapped by ",a.creator]})]}),(0,g.jsx)("button",{onClick:()=>n(a.id),className:"px-3 py-1 bg-red-600 text-white rounded hover:bg-red-700 transition-colors text-sm",children:"삭제"})]}),(0,g.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3",children:a.difficulties.map((b,c)=>(0,g.jsxs)("button",{onClick:()=>m(a,c),disabled:e,className:"p-4 bg-theme-bg-primary rounded-lg border border-theme-border hover:border-theme-primary transition-colors disabled:opacity-50 disabled:cursor-not-allowed text-left",children:[(0,g.jsx)("div",{className:"font-semibold text-theme-primary",children:b.name}),(0,g.jsxs)("div",{className:"text-sm text-theme-text-secondary mt-1",children:["OD: ",b.overallDifficulty.toFixed(1)," • AR: ",b.approachRate.toFixed(1)]}),(0,g.jsxs)("div",{className:"text-sm text-theme-text-secondary",children:[b.noteCount," 노트"]})]},c))})]},a.id))})]})},c_=()=>{let[a,b]=(0,h.useState)("Start"),[c,d]=(0,h.useState)(null),e=a=>{b(a)},f=a=>{d(a),b("Game")};return(0,g.jsx)("div",{children:(()=>{switch(a){case"Start":default:return(0,g.jsx)(l,{onNavigate:e});case"Select":return(0,g.jsx)(t,{onBack:()=>e("Start"),onChartSelected:f});case"Game":return c?(0,g.jsx)(cM,{selectedChart:c,onBack:()=>e("Select")}):(0,g.jsx)(l,{onNavigate:e});case"Finish":return(0,g.jsx)(cV,{onBack:()=>e("Start")});case"Settings":return(0,g.jsx)(cZ,{onBack:()=>e("Start")});case"OszImport":return(0,g.jsx)(c$,{onBack:()=>e("Start"),onChartSelected:f})}})()})};function c0(){return(0,g.jsx)(c_,{})}},846:a=>{"use strict";a.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},1025:a=>{"use strict";a.exports=require("next/dist/server/app-render/dynamic-access-async-storage.external.js")},1208:(a,b,c)=>{"use strict";c.r(b),c.d(b,{default:()=>d});let d=(0,c(5459).registerClientReference)(function(){throw Error("Attempted to call the default export of \"/Users/user/prg/src/renderer/app/page.tsx\" from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"/Users/user/prg/src/renderer/app/page.tsx","default")},1971:()=>{},2550:(a,b,c)=>{Promise.resolve().then(c.t.bind(c,8671,23)),Promise.resolve().then(c.t.bind(c,6542,23)),Promise.resolve().then(c.t.bind(c,8248,23)),Promise.resolve().then(c.t.bind(c,9743,23)),Promise.resolve().then(c.t.bind(c,6231,23)),Promise.resolve().then(c.t.bind(c,959,23)),Promise.resolve().then(c.t.bind(c,2041,23)),Promise.resolve().then(c.t.bind(c,5094,23)),Promise.resolve().then(c.t.bind(c,7487,23))},3033:a=>{"use strict";a.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},3295:a=>{"use strict";a.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},3581:()=>{},3873:a=>{"use strict";a.exports=require("path")},5020:(a,b,c)=>{"use strict";c.r(b),c.d(b,{GlobalError:()=>D.a,__next_app__:()=>J,handler:()=>L,pages:()=>I,routeModule:()=>K,tree:()=>H});var d=c(3653),e=c(7714),f=c(5250),g=c(7587),h=c(2369),i=c(1889),j=c(6232),k=c(2841),l=c(6537),m=c(6027),n=c(8559),o=c(5928),p=c(9374),q=c(5971),r=c(261),s=c(9898),t=c(2967),u=c(6713),v=c(139),w=c(4248),x=c(7199),y=c(7749),z=c(3123),A=c(9745),B=c(6439),C=c(8671),D=c.n(C),E=c(8283),F=c(9818),G={};for(let a in E)0>["default","tree","pages","GlobalError","__next_app__","routeModule","handler"].indexOf(a)&&(G[a]=()=>E[a]);c.d(b,G);let H=["",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(c.bind(c,1208)),"/Users/user/prg/src/renderer/app/page.tsx"]}]},{layout:[()=>Promise.resolve().then(c.bind(c,6035)),"/Users/user/prg/src/renderer/app/layout.tsx"],"global-error":[()=>Promise.resolve().then(c.t.bind(c,8671,23)),"next/dist/client/components/builtin/global-error.js"],"not-found":[()=>Promise.resolve().then(c.t.bind(c,7983,23)),"next/dist/client/components/builtin/not-found.js"],forbidden:[()=>Promise.resolve().then(c.t.bind(c,5034,23)),"next/dist/client/components/builtin/forbidden.js"],unauthorized:[()=>Promise.resolve().then(c.t.bind(c,4693,23)),"next/dist/client/components/builtin/unauthorized.js"]}],I=["/Users/user/prg/src/renderer/app/page.tsx"],J={require:c,loadChunk:()=>Promise.resolve()},K=new d.AppPageRouteModule({definition:{kind:e.RouteKind.APP_PAGE,page:"/page",pathname:"/",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:H},distDir:".next",relativeProjectDir:"src/renderer"});async function L(a,b,d){var C;let G="/page";"/index"===G&&(G="/");let M=(0,h.getRequestMeta)(a,"postponed"),N=(0,h.getRequestMeta)(a,"minimalMode"),O=await K.prepare(a,b,{srcPage:G,multiZoneDraftMode:!1});if(!O)return b.statusCode=400,b.end("Bad Request"),null==d.waitUntil||d.waitUntil.call(d,Promise.resolve()),null;let{buildId:P,query:Q,params:R,parsedUrl:S,pageIsDynamic:T,buildManifest:U,nextFontManifest:V,reactLoadableManifest:W,serverActionsManifest:X,clientReferenceManifest:Y,subresourceIntegrityManifest:Z,prerenderManifest:$,isDraftMode:_,resolvedPathname:aa,revalidateOnlyGenerated:ab,routerServerContext:ac,nextConfig:ad,interceptionRoutePatterns:ae}=O,af=S.pathname||"/",ag=(0,r.normalizeAppPath)(G),{isOnDemandRevalidate:ah}=O,ai=K.match(af,$),aj=!!$.routes[aa],ak=!!(ai||aj||$.routes[ag]),al=a.headers["user-agent"]||"",am=(0,u.getBotType)(al),an=(0,p.isHtmlBotRequest)(a),ao=(0,h.getRequestMeta)(a,"isPrefetchRSCRequest")??"1"===a.headers[t.NEXT_ROUTER_PREFETCH_HEADER],ap=(0,h.getRequestMeta)(a,"isRSCRequest")??!!a.headers[t.RSC_HEADER],aq=(0,s.getIsPossibleServerAction)(a),ar=(0,m.checkIsAppPPREnabled)(ad.experimental.ppr)&&(null==(C=$.routes[ag]??$.dynamicRoutes[ag])?void 0:C.renderingMode)==="PARTIALLY_STATIC",as=!1,at=!1,au=ar?M:void 0,av=ar&&ap&&!ao,aw=(0,h.getRequestMeta)(a,"segmentPrefetchRSCRequest"),ax=!al||(0,p.shouldServeStreamingMetadata)(al,ad.htmlLimitedBots);an&&ar&&(ak=!1,ax=!1);let ay=!0===K.isDev||!ak||"string"==typeof M||av,az=an&&ar,aA=null;_||!ak||ay||aq||au||av||(aA=aa);let aB=aA;!aB&&K.isDev&&(aB=aa),K.isDev||_||!ak||!ap||av||(0,k.d)(a.headers);let aC={...E,tree:H,pages:I,GlobalError:D(),handler:L,routeModule:K,__next_app__:J};X&&Y&&(0,o.setReferenceManifestsSingleton)({page:G,clientReferenceManifest:Y,serverActionsManifest:X,serverModuleMap:(0,q.createServerModuleMap)({serverActionsManifest:X})});let aD=a.method||"GET",aE=(0,g.getTracer)(),aF=aE.getActiveScopeSpan();try{let f=K.getVaryHeader(aa,ae);b.setHeader("Vary",f);let k=async(c,d)=>{let e=new l.NodeNextRequest(a),f=new l.NodeNextResponse(b);return K.render(e,f,d).finally(()=>{if(!c)return;c.setAttributes({"http.status_code":b.statusCode,"next.rsc":!1});let d=aE.getRootSpanAttributes();if(!d)return;if(d.get("next.span_type")!==i.BaseServerSpan.handleRequest)return void console.warn(`Unexpected root span type '${d.get("next.span_type")}'. Please report this Next.js issue https://github.com/vercel/next.js`);let e=d.get("next.route");if(e){let a=`${aD} ${e}`;c.setAttributes({"next.route":e,"http.route":e,"next.span_name":a}),c.updateName(a)}else c.updateName(`${aD} ${a.url}`)})},m=async({span:e,postponed:f,fallbackRouteParams:g})=>{let i={query:Q,params:R,page:ag,sharedContext:{buildId:P},serverComponentsHmrCache:(0,h.getRequestMeta)(a,"serverComponentsHmrCache"),fallbackRouteParams:g,renderOpts:{App:()=>null,Document:()=>null,pageConfig:{},ComponentMod:aC,Component:(0,j.T)(aC),params:R,routeModule:K,page:G,postponed:f,shouldWaitOnAllReady:az,serveStreamingMetadata:ax,supportsDynamicResponse:"string"==typeof f||ay,buildManifest:U,nextFontManifest:V,reactLoadableManifest:W,subresourceIntegrityManifest:Z,serverActionsManifest:X,clientReferenceManifest:Y,setIsrStatus:null==ac?void 0:ac.setIsrStatus,dir:c(3873).join(process.cwd(),K.relativeProjectDir),isDraftMode:_,isRevalidate:ak&&!f&&!av,botType:am,isOnDemandRevalidate:ah,isPossibleServerAction:aq,assetPrefix:ad.assetPrefix,nextConfigOutput:ad.output,crossOrigin:ad.crossOrigin,trailingSlash:ad.trailingSlash,previewProps:$.preview,deploymentId:ad.deploymentId,enableTainting:ad.experimental.taint,htmlLimitedBots:ad.htmlLimitedBots,devtoolSegmentExplorer:ad.experimental.devtoolSegmentExplorer,reactMaxHeadersLength:ad.reactMaxHeadersLength,multiZoneDraftMode:!1,incrementalCache:(0,h.getRequestMeta)(a,"incrementalCache"),cacheLifeProfiles:ad.experimental.cacheLife,basePath:ad.basePath,serverActions:ad.experimental.serverActions,...as?{nextExport:!0,supportsDynamicResponse:!1,isStaticGeneration:!0,isRevalidate:!0,isDebugDynamicAccesses:as}:{},experimental:{isRoutePPREnabled:ar,expireTime:ad.expireTime,staleTimes:ad.experimental.staleTimes,cacheComponents:!!ad.experimental.cacheComponents,clientSegmentCache:!!ad.experimental.clientSegmentCache,clientParamParsing:!!ad.experimental.clientParamParsing,dynamicOnHover:!!ad.experimental.dynamicOnHover,inlineCss:!!ad.experimental.inlineCss,authInterrupts:!!ad.experimental.authInterrupts,clientTraceMetadata:ad.experimental.clientTraceMetadata||[]},waitUntil:d.waitUntil,onClose:a=>{b.on("close",a)},onAfterTaskError:()=>{},onInstrumentationRequestError:(b,c,d)=>K.onRequestError(a,b,d,ac),err:(0,h.getRequestMeta)(a,"invokeError"),dev:K.isDev}},l=await k(e,i),{metadata:m}=l,{cacheControl:n,headers:o={},fetchTags:p}=m;if(p&&(o[y.NEXT_CACHE_TAGS_HEADER]=p),a.fetchMetrics=m.fetchMetrics,ak&&(null==n?void 0:n.revalidate)===0&&!K.isDev&&!ar){let a=m.staticBailoutInfo,b=Object.defineProperty(Error(`Page changed from static to dynamic at runtime ${aa}${(null==a?void 0:a.description)?`, reason: ${a.description}`:""}
see more here https://nextjs.org/docs/messages/app-static-to-dynamic-error`),"__NEXT_ERROR_CODE",{value:"E132",enumerable:!1,configurable:!0});if(null==a?void 0:a.stack){let c=a.stack;b.stack=b.message+c.substring(c.indexOf("\n"))}throw b}return{value:{kind:v.CachedRouteKind.APP_PAGE,html:l,headers:o,rscData:m.flightData,postponed:m.postponed,status:m.statusCode,segmentData:m.segmentData},cacheControl:n}},o=async({hasResolved:c,previousCacheEntry:f,isRevalidating:g,span:i})=>{let j,k=!1===K.isDev,l=c||b.writableEnded;if(ah&&ab&&!f&&!N)return(null==ac?void 0:ac.render404)?await ac.render404(a,b):(b.statusCode=404,b.end("This page could not be found")),null;if(ai&&(j=(0,w.parseFallbackField)(ai.fallback)),j===w.FallbackMode.PRERENDER&&(0,u.isBot)(al)&&(!ar||an)&&(j=w.FallbackMode.BLOCKING_STATIC_RENDER),(null==f?void 0:f.isStale)===-1&&(ah=!0),ah&&(j!==w.FallbackMode.NOT_FOUND||f)&&(j=w.FallbackMode.BLOCKING_STATIC_RENDER),!N&&j!==w.FallbackMode.BLOCKING_STATIC_RENDER&&aB&&!l&&!_&&T&&(k||!aj)){let b;if((k||ai)&&j===w.FallbackMode.NOT_FOUND)throw new B.NoFallbackError;if(ar&&!ap){let c="string"==typeof(null==ai?void 0:ai.fallback)?ai.fallback:k?ag:null;if(b=await K.handleResponse({cacheKey:c,req:a,nextConfig:ad,routeKind:e.RouteKind.APP_PAGE,isFallback:!0,prerenderManifest:$,isRoutePPREnabled:ar,responseGenerator:async()=>m({span:i,postponed:void 0,fallbackRouteParams:k||at?(0,n.u)(ag):null}),waitUntil:d.waitUntil}),null===b)return null;if(b)return delete b.cacheControl,b}}let o=ah||g||!au?void 0:au;if(as&&void 0!==o)return{cacheControl:{revalidate:1,expire:void 0},value:{kind:v.CachedRouteKind.PAGES,html:x.default.EMPTY,pageData:{},headers:void 0,status:void 0}};let p=T&&ar&&((0,h.getRequestMeta)(a,"renderFallbackShell")||at)?(0,n.u)(af):null;return m({span:i,postponed:o,fallbackRouteParams:p})},p=async c=>{var f,g,i,j,k;let l,n=await K.handleResponse({cacheKey:aA,responseGenerator:a=>o({span:c,...a}),routeKind:e.RouteKind.APP_PAGE,isOnDemandRevalidate:ah,isRoutePPREnabled:ar,req:a,nextConfig:ad,prerenderManifest:$,waitUntil:d.waitUntil});if(_&&b.setHeader("Cache-Control","private, no-cache, no-store, max-age=0, must-revalidate"),K.isDev&&b.setHeader("Cache-Control","no-store, must-revalidate"),!n){if(aA)throw Object.defineProperty(Error("invariant: cache entry required but not generated"),"__NEXT_ERROR_CODE",{value:"E62",enumerable:!1,configurable:!0});return null}if((null==(f=n.value)?void 0:f.kind)!==v.CachedRouteKind.APP_PAGE)throw Object.defineProperty(Error(`Invariant app-page handler received invalid cache entry ${null==(i=n.value)?void 0:i.kind}`),"__NEXT_ERROR_CODE",{value:"E707",enumerable:!1,configurable:!0});let p="string"==typeof n.value.postponed;ak&&!av&&(!p||ao)&&(N||b.setHeader("x-nextjs-cache",ah?"REVALIDATED":n.isMiss?"MISS":n.isStale?"STALE":"HIT"),b.setHeader(t.NEXT_IS_PRERENDER_HEADER,"1"));let{value:q}=n;if(au)l={revalidate:0,expire:void 0};else if(N&&ap&&!ao&&ar)l={revalidate:0,expire:void 0};else if(!K.isDev)if(_)l={revalidate:0,expire:void 0};else if(ak){if(n.cacheControl)if("number"==typeof n.cacheControl.revalidate){if(n.cacheControl.revalidate<1)throw Object.defineProperty(Error(`Invalid revalidate configuration provided: ${n.cacheControl.revalidate} < 1`),"__NEXT_ERROR_CODE",{value:"E22",enumerable:!1,configurable:!0});l={revalidate:n.cacheControl.revalidate,expire:(null==(j=n.cacheControl)?void 0:j.expire)??ad.expireTime}}else l={revalidate:y.CACHE_ONE_YEAR,expire:void 0}}else b.getHeader("Cache-Control")||(l={revalidate:0,expire:void 0});if(n.cacheControl=l,"string"==typeof aw&&(null==q?void 0:q.kind)===v.CachedRouteKind.APP_PAGE&&q.segmentData){b.setHeader(t.NEXT_DID_POSTPONE_HEADER,"2");let c=null==(k=q.headers)?void 0:k[y.NEXT_CACHE_TAGS_HEADER];N&&ak&&c&&"string"==typeof c&&b.setHeader(y.NEXT_CACHE_TAGS_HEADER,c);let d=q.segmentData.get(aw);return void 0!==d?(0,A.sendRenderResult)({req:a,res:b,generateEtags:ad.generateEtags,poweredByHeader:ad.poweredByHeader,result:x.default.fromStatic(d,t.RSC_CONTENT_TYPE_HEADER),cacheControl:n.cacheControl}):(b.statusCode=204,(0,A.sendRenderResult)({req:a,res:b,generateEtags:ad.generateEtags,poweredByHeader:ad.poweredByHeader,result:x.default.EMPTY,cacheControl:n.cacheControl}))}let r=(0,h.getRequestMeta)(a,"onCacheEntry");if(r&&await r({...n,value:{...n.value,kind:"PAGE"}},{url:(0,h.getRequestMeta)(a,"initURL")}))return null;if(p&&au)throw Object.defineProperty(Error("Invariant: postponed state should not be present on a resume request"),"__NEXT_ERROR_CODE",{value:"E396",enumerable:!1,configurable:!0});if(q.headers){let a={...q.headers};for(let[c,d]of(N&&ak||delete a[y.NEXT_CACHE_TAGS_HEADER],Object.entries(a)))if(void 0!==d)if(Array.isArray(d))for(let a of d)b.appendHeader(c,a);else"number"==typeof d&&(d=d.toString()),b.appendHeader(c,d)}let s=null==(g=q.headers)?void 0:g[y.NEXT_CACHE_TAGS_HEADER];if(N&&ak&&s&&"string"==typeof s&&b.setHeader(y.NEXT_CACHE_TAGS_HEADER,s),!q.status||ap&&ar||(b.statusCode=q.status),!N&&q.status&&F.RedirectStatusCode[q.status]&&ap&&(b.statusCode=200),p&&b.setHeader(t.NEXT_DID_POSTPONE_HEADER,"1"),ap&&!_){if(void 0===q.rscData){if(q.postponed)throw Object.defineProperty(Error("Invariant: Expected postponed to be undefined"),"__NEXT_ERROR_CODE",{value:"E372",enumerable:!1,configurable:!0});return(0,A.sendRenderResult)({req:a,res:b,generateEtags:ad.generateEtags,poweredByHeader:ad.poweredByHeader,result:q.html,cacheControl:av?{revalidate:0,expire:void 0}:n.cacheControl})}return(0,A.sendRenderResult)({req:a,res:b,generateEtags:ad.generateEtags,poweredByHeader:ad.poweredByHeader,result:x.default.fromStatic(q.rscData,t.RSC_CONTENT_TYPE_HEADER),cacheControl:n.cacheControl})}let u=q.html;if(!p||N||ap)return(0,A.sendRenderResult)({req:a,res:b,generateEtags:ad.generateEtags,poweredByHeader:ad.poweredByHeader,result:u,cacheControl:n.cacheControl});if(as)return u.push(new ReadableStream({start(a){a.enqueue(z.ENCODED_TAGS.CLOSED.BODY_AND_HTML),a.close()}})),(0,A.sendRenderResult)({req:a,res:b,generateEtags:ad.generateEtags,poweredByHeader:ad.poweredByHeader,result:u,cacheControl:{revalidate:0,expire:void 0}});let w=new TransformStream;return u.push(w.readable),m({span:c,postponed:q.postponed,fallbackRouteParams:null}).then(async a=>{var b,c;if(!a)throw Object.defineProperty(Error("Invariant: expected a result to be returned"),"__NEXT_ERROR_CODE",{value:"E463",enumerable:!1,configurable:!0});if((null==(b=a.value)?void 0:b.kind)!==v.CachedRouteKind.APP_PAGE)throw Object.defineProperty(Error(`Invariant: expected a page response, got ${null==(c=a.value)?void 0:c.kind}`),"__NEXT_ERROR_CODE",{value:"E305",enumerable:!1,configurable:!0});await a.value.html.pipeTo(w.writable)}).catch(a=>{w.writable.abort(a).catch(a=>{console.error("couldn't abort transformer",a)})}),(0,A.sendRenderResult)({req:a,res:b,generateEtags:ad.generateEtags,poweredByHeader:ad.poweredByHeader,result:u,cacheControl:{revalidate:0,expire:void 0}})};if(!aF)return await aE.withPropagatedContext(a.headers,()=>aE.trace(i.BaseServerSpan.handleRequest,{spanName:`${aD} ${a.url}`,kind:g.SpanKind.SERVER,attributes:{"http.method":aD,"http.target":a.url}},p));await p(aF)}catch(b){throw aF||b instanceof B.NoFallbackError||await K.onRequestError(a,b,{routerKind:"App Router",routePath:G,routeType:"render",revalidateReason:(0,f.c)({isRevalidate:ak,isOnDemandRevalidate:ah})},ac),b}}},6035:(a,b,c)=>{"use strict";c.r(b),c.d(b,{default:()=>f,metadata:()=>e});var d=c(5939);c(1971);let e={title:"Prg",description:"Pin Rhythm Game"};function f({children:a}){return(0,d.jsx)("html",{lang:"ko",children:(0,d.jsx)("body",{children:a})})}},6439:a=>{"use strict";a.exports=require("next/dist/shared/lib/no-fallback-error.external")},6713:a=>{"use strict";a.exports=require("next/dist/shared/lib/router/utils/is-bot")},7822:(a,b,c)=>{Promise.resolve().then(c.t.bind(c,8365,23)),Promise.resolve().then(c.t.bind(c,4596,23)),Promise.resolve().then(c.t.bind(c,6186,23)),Promise.resolve().then(c.t.bind(c,7805,23)),Promise.resolve().then(c.t.bind(c,7561,23)),Promise.resolve().then(c.t.bind(c,7569,23)),Promise.resolve().then(c.t.bind(c,2747,23)),Promise.resolve().then(c.t.bind(c,6676,23)),Promise.resolve().then(c.bind(c,7225))},8317:()=>{},8330:(a,b,c)=>{Promise.resolve().then(c.bind(c,790))},8354:a=>{"use strict";a.exports=require("util")},9121:a=>{"use strict";a.exports=require("next/dist/server/app-render/action-async-storage.external.js")},9294:a=>{"use strict";a.exports=require("next/dist/server/app-render/work-async-storage.external.js")}};var b=require("../webpack-runtime.js");b.C(a);var c=b.X(0,[869],()=>b(b.s=5020));module.exports=c})();
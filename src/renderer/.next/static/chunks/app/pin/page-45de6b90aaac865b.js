(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[34],{43:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>N});var a=s(4568),l=s(7620),c=s(5239),r=s(3842),n=s(7541);function i(e){let{targetRotation:t,pins:s,hitEffects:c,currentPinAngle:r,gameState:n,width:i=600,height:d=600}=e,o=(0,l.useRef)(null),x=(0,l.useRef)(),h=(0,l.useCallback)(()=>{let e=o.current;if(!e)return;let a=e.getContext("2d");if(!a)return;a.clearRect(0,0,e.width,e.height);let l=e.width/2,i=e.height/2;a.beginPath(),a.arc(l,i,150,0,2*Math.PI),a.strokeStyle="#8b5cf6",a.lineWidth=3,a.stroke(),a.beginPath(),a.arc(l,i,5,0,2*Math.PI),a.fillStyle="#8b5cf6",a.fill(),s.forEach(e=>{let t=l+150*Math.cos(e.angle*Math.PI/180),s=i+150*Math.sin(e.angle*Math.PI/180);a.beginPath(),a.moveTo(t,s),a.lineTo(t+40*Math.cos(e.angle*Math.PI/180),s+40*Math.sin(e.angle*Math.PI/180)),a.strokeStyle="#fbbf24",a.lineWidth=4,a.stroke(),a.beginPath(),a.arc(t+40*Math.cos(e.angle*Math.PI/180),s+40*Math.sin(e.angle*Math.PI/180),3,0,2*Math.PI),a.fillStyle="#f59e0b",a.fill()});let d=l+180*Math.cos((t+r)*Math.PI/180),m=i+180*Math.sin((t+r)*Math.PI/180);a.beginPath(),a.arc(d,m,8,0,2*Math.PI),a.fillStyle="#ef4444",a.fill(),a.beginPath(),a.moveTo(d,m),a.lineTo(l,i),a.strokeStyle="#ef444440",a.lineWidth=2,a.setLineDash([5,5]),a.stroke(),a.setLineDash([]),c.forEach(e=>{let t=Date.now()-e.timestamp,s=Math.max(0,1-t/1e3);a.save(),a.globalAlpha=s,a.font="".concat(20*(1+t/1e3*.5),"px bold"),a.textAlign="center","PERFECT"===e.type?(a.fillStyle="#22c55e",a.fillText("PERFECT!",l+e.x,i+e.y)):"GOOD"===e.type?(a.fillStyle="#eab308",a.fillText("GOOD!",l+e.x,i+e.y)):(a.fillStyle="#ef4444",a.fillText("MISS!",l+e.x,i+e.y)),a.restore()}),"playing"===n&&(x.current=requestAnimationFrame(h))},[t,s,c,r,n]);return(0,l.useEffect)(()=>(h(),()=>{x.current&&cancelAnimationFrame(x.current)}),[h]),(0,a.jsx)("canvas",{ref:o,width:i,height:d,className:"w-full h-auto bg-slate-900 rounded-lg border border-slate-600",style:{maxWidth:"".concat(i,"px"),maxHeight:"".concat(d,"px")}})}var d=s(2068);let o=(0,d.A)("star",[["path",{d:"M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.123 2.123 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.123 2.123 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.122 2.122 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.122 2.122 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.122 2.122 0 0 0 1.597-1.16z",key:"r04s7s"}]]),x=(0,d.A)("award",[["path",{d:"m15.477 12.89 1.515 8.526a.5.5 0 0 1-.81.47l-3.58-2.687a1 1 0 0 0-1.197 0l-3.586 2.686a.5.5 0 0 1-.81-.469l1.514-8.526",key:"1yiouv"}],["circle",{cx:"12",cy:"8",r:"6",key:"1vp47v"}]]);var h=s(387);let m=(0,d.A)("trending-up",[["path",{d:"M16 7h6v6",key:"box55l"}],["path",{d:"m22 7-8.5 8.5-5-5L2 17",key:"1t1m79"}]]);function u(e){let{stats:t,currentSong:s,gameInfo:l}=e,r=t.combo>=50?{text:"".concat(t.combo,"x"),color:"text-purple-400",bg:"bg-purple-900/30"}:t.combo>=20?{text:"".concat(t.combo,"x"),color:"text-yellow-400",bg:"bg-yellow-900/30"}:t.combo>=10?{text:"".concat(t.combo,"x"),color:"text-blue-400",bg:"bg-blue-900/30"}:{text:"".concat(t.combo,"x"),color:"text-white",bg:"bg-slate-700/30"},n=t.accuracy>=95?{grade:"S",color:"text-yellow-300"}:t.accuracy>=90?{grade:"A",color:"text-green-400"}:t.accuracy>=80?{grade:"B",color:"text-blue-400"}:t.accuracy>=70?{grade:"C",color:"text-purple-400"}:{grade:"D",color:"text-red-400"};return(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)(c.Zp,{className:"bg-slate-800/50 border-slate-700",children:[(0,a.jsx)(c.aR,{className:"pb-3",children:(0,a.jsxs)(c.ZB,{className:"text-lg text-purple-300 flex items-center",children:[(0,a.jsx)(o,{className:"w-5 h-5 mr-2"}),"점수"]})}),(0,a.jsxs)(c.Wu,{children:[(0,a.jsx)("div",{className:"text-3xl font-bold text-white mb-2",children:t.score.toLocaleString()}),(0,a.jsxs)("div",{className:"text-lg font-bold ".concat(r.color," ").concat(r.bg," px-2 py-1 rounded-md inline-block"),children:["콤보: ",r.text]})]})]}),(0,a.jsxs)(c.Zp,{className:"bg-slate-800/50 border-slate-700",children:[(0,a.jsx)(c.aR,{className:"pb-3",children:(0,a.jsxs)(c.ZB,{className:"text-lg text-purple-300 flex items-center",children:[(0,a.jsx)(x,{className:"w-5 h-5 mr-2"}),"정확도"]})}),(0,a.jsxs)(c.Wu,{children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,a.jsxs)("span",{className:"text-2xl font-bold ".concat(t.accuracy>=95?"text-green-400":t.accuracy>=85?"text-yellow-400":t.accuracy>=70?"text-orange-400":"text-red-400"),children:[t.accuracy,"%"]}),(0,a.jsx)("span",{className:"text-4xl font-bold ".concat(n.color),children:n.grade})]}),(0,a.jsx)("div",{className:"w-full bg-slate-700 rounded-full h-2",children:(0,a.jsx)("div",{className:"h-2 rounded-full transition-all duration-300 ".concat(t.accuracy>=95?"bg-green-500":t.accuracy>=85?"bg-yellow-500":t.accuracy>=70?"bg-orange-500":"bg-red-500"),style:{width:"".concat(t.accuracy,"%")}})})]})]}),(0,a.jsxs)(c.Zp,{className:"bg-slate-800/50 border-slate-700",children:[(0,a.jsx)(c.aR,{className:"pb-3",children:(0,a.jsxs)(c.ZB,{className:"text-lg text-purple-300 flex items-center",children:[(0,a.jsx)(h.A,{className:"w-5 h-5 mr-2"}),"판정"]})}),(0,a.jsxs)(c.Wu,{className:"space-y-2",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsx)("span",{className:"text-green-400 font-medium",children:"PERFECT"}),(0,a.jsx)("span",{className:"text-white font-bold",children:t.hits.perfect})]}),(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsx)("span",{className:"text-yellow-400 font-medium",children:"GOOD"}),(0,a.jsx)("span",{className:"text-white font-bold",children:t.hits.good})]}),(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsx)("span",{className:"text-red-400 font-medium",children:"MISS"}),(0,a.jsx)("span",{className:"text-white font-bold",children:t.hits.miss})]}),(0,a.jsx)("div",{className:"border-t border-slate-600 pt-2 mt-2",children:(0,a.jsxs)("div",{className:"flex justify-between items-center font-bold",children:[(0,a.jsx)("span",{className:"text-purple-300",children:"총 히트"}),(0,a.jsx)("span",{className:"text-white",children:t.hits.perfect+t.hits.good+t.hits.miss})]})})]})]}),(s||l)&&(0,a.jsxs)(c.Zp,{className:"bg-slate-800/50 border-slate-700",children:[(0,a.jsx)(c.aR,{className:"pb-3",children:(0,a.jsxs)(c.ZB,{className:"text-lg text-purple-300 flex items-center",children:[(0,a.jsx)(m,{className:"w-5 h-5 mr-2"}),"게임 정보"]})}),(0,a.jsxs)(c.Wu,{className:"space-y-2 text-sm",children:[s&&(0,a.jsx)(a.Fragment,{children:(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{className:"text-slate-400",children:"BPM"}),(0,a.jsx)("span",{className:"text-white",children:s.bpm})]})}),l&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{className:"text-slate-400",children:"회전 속도"}),(0,a.jsx)("span",{className:"text-white",children:l.rotationSpeed.toFixed(1)})]}),(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{className:"text-slate-400",children:"핀 개수"}),(0,a.jsx)("span",{className:"text-white",children:l.pinCount})]}),(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{className:"text-slate-400",children:"난이도"}),(0,a.jsx)("span",{className:"text-white",children:l.difficulty})]})]})]})]})]})}var p=s(6845),b=s(2292),f=s(8756);let g=(0,d.A)("square",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}]]);var j=s(4751);function y(e){let{gameState:t,onPinThrow:s,onPause:l,onResume:c,onStop:r,onBack:n,disabled:i=!1,showThrowButton:d=!0}=e;return(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"text-lg font-medium ".concat((()=>{switch(t){case"playing":return"text-green-400";case"paused":return"text-orange-400";case"ended":case"finished":return"text-red-400";case"loading":return"text-blue-400";default:return"text-slate-400"}})()),children:(()=>{switch(t){case"idle":return"게임 시작 대기";case"loading":return"로딩 중...";case"playing":return"플레이 중";case"paused":return"일시정지";case"ended":case"finished":return"게임 종료";default:return"대기"}})()}),"playing"===t&&(0,a.jsx)("div",{className:"text-sm text-slate-400 mt-1",children:"스페이스바를 눌러 핀을 던지세요!"})]}),(0,a.jsxs)("div",{className:"flex flex-col gap-3",children:[d&&(0,a.jsxs)(p.$,{onClick:s,disabled:"playing"!==t||i,className:"w-full bg-purple-500 hover:bg-purple-600 text-lg px-6 py-4 h-auto",children:[(0,a.jsx)(h.A,{className:"w-6 h-6 mr-2"}),"핀 던지기",(0,a.jsx)("div",{className:"text-sm opacity-75 ml-2",children:"(Space)"})]}),(0,a.jsxs)("div",{className:"flex gap-2",children:["playing"===t&&(0,a.jsxs)(p.$,{onClick:l,className:"flex-1 bg-orange-500 hover:bg-orange-600",disabled:i,children:[(0,a.jsx)(b.A,{className:"w-4 h-4 mr-2"}),"일시정지"]}),"paused"===t&&(0,a.jsxs)(p.$,{onClick:c,className:"flex-1 bg-green-500 hover:bg-green-600",disabled:i,children:[(0,a.jsx)(f.A,{className:"w-4 h-4 mr-2"}),"재개"]}),(0,a.jsxs)(p.$,{onClick:r,variant:"destructive",className:"flex-1",disabled:"idle"===t||i,children:[(0,a.jsx)(g,{className:"w-4 h-4 mr-2"}),"정지"]})]}),(0,a.jsxs)(p.$,{onClick:n,variant:"outline",className:"w-full border-slate-600",disabled:i,children:[(0,a.jsx)(j.A,{className:"w-4 h-4 mr-2"}),"곡 선택으로 돌아가기"]})]}),"playing"===t&&(0,a.jsxs)("div",{className:"bg-slate-800/30 rounded-lg p-3 text-sm",children:[(0,a.jsx)("div",{className:"text-slate-300 font-medium mb-2",children:"키보드 단축키:"}),(0,a.jsxs)("div",{className:"space-y-1 text-slate-400",children:[(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{children:"핀 던지기"}),(0,a.jsx)("code",{className:"bg-slate-700 px-2 py-1 rounded",children:"Space"})]}),(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{children:"일시정지"}),(0,a.jsx)("code",{className:"bg-slate-700 px-2 py-1 rounded",children:"Esc"})]})]})]})]})}function N(){let e=(0,n.useRouter)(),{currentSong:t,gameState:s,stats:d,pauseGame:o,resumeGame:x,stopGame:h,updateStats:m}=(0,r.v)(),[p,b]=(0,l.useState)(0),[f,g]=(0,l.useState)([]),[j,N]=(0,l.useState)(2),[w,v]=(0,l.useState)([]),[k,M]=(0,l.useState)(0),S=function(e){let{pins:t,onHitResult:s,onStatsUpdate:a,currentStats:c}=e,r=(0,l.useCallback)(e=>{for(let s of t){let t=Math.abs(e-s.angle);if(10>Math.min(t,360-t))return"MISS"}let s=Math.random();return s>.8?"PERFECT":s>.5?"GOOD":"MISS"},[t]),n=(0,l.useCallback)(e=>{let t=r(e),l={id:Date.now(),x:150*Math.cos(e*Math.PI/180)*.7,y:150*Math.sin(e*Math.PI/180)*.7,type:t,timestamp:Date.now()},n={...c};"PERFECT"===t?(n.hits.perfect++,n.score+=300+5*c.combo,n.combo++):"GOOD"===t?(n.hits.good++,n.score+=100+2*c.combo,n.combo++):(n.hits.miss++,n.combo=0);let i=n.hits.perfect+n.hits.good+n.hits.miss,d=n.hits.perfect+n.hits.good;return n.accuracy=i>0?Math.round(d/i*100):100,s(t,l),a(n),t},[r,s,a,c]),i=(0,l.useCallback)((e,t)=>{let s=60/t*1e3,a=e%s/s;return 1-2*Math.min(a,1-a)},[]);return{processHit:n,checkHitDetection:r,calculateRhythmTiming:i,isThrowSafe:(0,l.useCallback)(e=>{for(let s of t){let t=Math.abs(e-s.angle);if(30>Math.min(t,360-t))return!1}return!0},[t]),getDifficultyMultiplier:(0,l.useCallback)(()=>{let e=t.length;return e<5?1:e<10?1.2:e<15?1.5:2},[t.length]),getAccuracy:()=>c.accuracy,getCombo:()=>c.combo,getScore:()=>c.score}}({pins:f,onHitResult:(0,l.useCallback)((e,t)=>{if(v(e=>[...e,t]),"MISS"!==e){let e={id:Date.now(),angle:(p+k)%360,timestamp:Date.now(),stuck:!0};g(t=>[...t,e]),d.combo>0&&d.combo%10==0&&N(e=>Math.min(e+.2,5))}setTimeout(()=>{v(e=>e.filter(e=>e.id!==t.id))},1e3)},[p,k,d.combo]),onStatsUpdate:m,currentStats:d});(0,l.useEffect)(()=>{if("playing"===s){let e=setInterval(()=>{b(e=>(e+j)%360)},16);return()=>clearInterval(e)}},[s,j]);let P=(0,l.useCallback)(()=>{if("playing"!==s||!t)return;let e=(p+k)%360;S.processHit(e)},[s,t,p,k,S]);(0,l.useEffect)(()=>{let e=e=>{"Space"===e.code?(e.preventDefault(),P()):"Escape"===e.code&&(e.preventDefault(),"playing"===s?o():"paused"===s&&x())};return window.addEventListener("keydown",e),()=>window.removeEventListener("keydown",e)},[P,s,o,x]);let C=(0,l.useCallback)(()=>{h(),e.push("/select")},[h,e]),E=(0,l.useCallback)(()=>{h(),g([]),v([]),b(0),N(2)},[h]);return t?(0,a.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-slate-900 via-purple-900 to-slate-900 p-4",children:(0,a.jsxs)("div",{className:"max-w-7xl mx-auto",children:[(0,a.jsxs)("div",{className:"mb-6",children:[(0,a.jsx)("h1",{className:"text-3xl font-bold text-purple-300 mb-2",children:"핀 게임"}),(0,a.jsxs)("p",{className:"text-slate-400",children:[t.title," - ",t.artist]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-6",children:[(0,a.jsx)("div",{className:"lg:col-span-3",children:(0,a.jsx)(c.Zp,{className:"bg-slate-800/50 border-slate-700",children:(0,a.jsx)(c.Wu,{className:"p-6",children:(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)(i,{targetRotation:p,pins:f,hitEffects:w,currentPinAngle:k,gameState:s,width:600,height:600}),"playing"!==s&&(0,a.jsx)("div",{className:"absolute inset-0 bg-black/50 flex items-center justify-center rounded-lg",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("h3",{className:"text-2xl font-bold text-white mb-4",children:"idle"===s?"게임 시작 대기":"paused"===s?"일시정지":"loading"===s?"로딩 중...":"게임 종료"}),"paused"===s&&(0,a.jsx)("p",{className:"text-slate-300",children:"재개하려면 플레이 버튼을 클릭하거나 ESC를 누르세요"})]})})]})})})}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsx)(c.Zp,{className:"bg-slate-800/50 border-slate-700",children:(0,a.jsx)(c.Wu,{className:"p-4",children:(0,a.jsx)(y,{gameState:s,onPinThrow:P,onPause:o,onResume:x,onStop:E,onBack:C})})}),(0,a.jsx)(u,{stats:d,currentSong:t,gameInfo:{rotationSpeed:j,pinCount:f.length,difficulty:S.getDifficultyMultiplier()>1.5?"Hard":S.getDifficultyMultiplier()>1.2?"Normal":"Easy"}})]})]})]})}):(0,a.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-slate-900 via-purple-900 to-slate-900 p-8",children:(0,a.jsx)("div",{className:"max-w-4xl mx-auto",children:(0,a.jsx)(c.Zp,{className:"bg-slate-800/50 border-slate-700",children:(0,a.jsxs)(c.Wu,{className:"p-8 text-center",children:[(0,a.jsx)("h2",{className:"text-2xl font-bold text-purple-300 mb-4",children:"곡을 선택해주세요"}),(0,a.jsx)("p",{className:"text-slate-400 mb-6",children:"핀 게임을 시작하려면 먼저 곡을 선택해야 합니다."}),(0,a.jsx)(y,{gameState:"idle",onPinThrow:()=>{},onPause:()=>{},onResume:()=>{},onStop:()=>{},onBack:C,showThrowButton:!1})]})})})})}},387:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(2068).A)("target",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]])},2292:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(2068).A)("pause",[["rect",{x:"14",y:"3",width:"5",height:"18",rx:"1",key:"kaeet6"}],["rect",{x:"5",y:"3",width:"5",height:"18",rx:"1",key:"1wsw3u"}]])},5464:(e,t,s)=>{Promise.resolve().then(s.bind(s,43))},7541:(e,t,s)=>{"use strict";var a=s(3041);s.o(a,"usePathname")&&s.d(t,{usePathname:function(){return a.usePathname}}),s.o(a,"useRouter")&&s.d(t,{useRouter:function(){return a.useRouter}})},8756:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(2068).A)("play",[["path",{d:"M5 5a2 2 0 0 1 3.008-1.728l11.997 6.998a2 2 0 0 1 .003 3.458l-12 7A2 2 0 0 1 5 19z",key:"10ikf1"}]])}},e=>{e.O(0,[28,110,587,18,358],()=>e(e.s=5464)),_N_E=e.O()}]);